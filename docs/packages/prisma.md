# Prisma Package - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ ORM

## üóÑÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ

–ü–∞–∫–µ—Ç `@gafus/prisma` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL —á–µ—Ä–µ–∑ Prisma ORM. –í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –º–∏–≥—Ä–∞—Ü–∏–∏, seed –¥–∞–Ω–Ω—ã–µ –∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ Gafus.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- Enums –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ò–Ω–¥–µ–∫—Å—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏–∏
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
- –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

### Seed –¥–∞–Ω–Ω—ã–µ
- –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- –î–µ–º–æ –∫–æ–Ω—Ç–µ–Ω—Ç
- –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –¢–∏–ø–∏–∑–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è TypeScript —Ç–∏–ø–æ–≤
- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∏–ø–æ–≤
- IntelliSense –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Prisma ORM** - –æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **Prisma Client** - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
- **Prisma Migrate** - —Å–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π
- **TypeScript** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞

```
packages/prisma/
‚îú‚îÄ‚îÄ schema.prisma              # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ migrations/                # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ 20240913102738_init/  # –ù–∞—á–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ migration_lock.toml    # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ seed.ts                    # Seed –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ client.ts             # Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ index.ts              # –≠–∫—Å–ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ dist/                     # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îî‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

#### User - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```prisma
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  password      String
  name          String?
  phone         String?   @unique
  telegramId    String?   @unique
  isConfirmed   Boolean   @default(false)
  role          UserRole  @default(USER)
  petType       PetType?
  petName       String?
  petAge        Int?
  petWeight     Float?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  // –°–≤—è–∑–∏
  trainings     Training[]
  achievements  UserAchievement[]
  favorites     Favorite[]
  pushLogs      PushLog[]
}
```

#### Course - –ö—É—Ä—Å—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
```prisma
model Course {
  id             String             @id @default(cuid())
  name           String
  type           String             @unique
  description    String
  equipment      String
  trainingLevel  TrainingLevel
  shortDesc      String
  duration       String
  isPublished    Boolean            @default(false)
  createdAt      DateTime           @default(now())
  updatedAt      DateTime           @updatedAt
  // –°–≤—è–∑–∏
  days           CourseDay[]
  trainings      Training[]
  favorites      Favorite[]
}
```

#### Training - –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
```prisma
model Training {
  id          String         @id @default(cuid())
  userId      String
  courseId    String
  status      TrainingStatus @default(NOT_STARTED)
  startedAt   DateTime?
  completedAt DateTime?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  // –°–≤—è–∑–∏
  user        User           @relation(fields: [userId], references: [id])
  course      Course         @relation(fields: [courseId], references: [id])
  steps       TrainingStep[]
}
```

#### CourseDay - –î–Ω–∏ –∫—É—Ä—Å–∞
```prisma
model CourseDay {
  id          String    @id @default(cuid())
  courseId    String
  dayNumber   Int
  name        String
  description String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  // –°–≤—è–∑–∏
  course      Course    @relation(fields: [courseId], references: [id])
  steps       Step[]
}
```

#### Step - –®–∞–≥–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
```prisma
model Step {
  id          String    @id @default(cuid())
  courseDayId String
  stepNumber  Int
  name        String
  description String
  videoUrl    String?
  imageUrl    String?
  duration    Int?      // –≤ –º–∏–Ω—É—Ç–∞—Ö
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  // –°–≤—è–∑–∏
  courseDay   CourseDay @relation(fields: [courseDayId], references: [id])
  trainingSteps TrainingStep[]
}
```

### Enums

#### UserRole - –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```prisma
enum UserRole {
  USER      // –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  TRAINER   // –¢—Ä–µ–Ω–µ—Ä
  ADMIN     // –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
  MODERATOR // –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä
  PREMIUM   // –ü—Ä–µ–º–∏—É–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
}
```

#### TrainingStatus - –°—Ç–∞—Ç—É—Å—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
```prisma
enum TrainingStatus {
  NOT_STARTED  // –ù–µ –Ω–∞—á–∞—Ç–∞
  IN_PROGRESS  // –í –ø—Ä–æ—Ü–µ—Å—Å–µ
  COMPLETED    // –ó–∞–≤–µ—Ä—à–µ–Ω–∞
}
```

#### TrainingLevel - –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
```prisma
enum TrainingLevel {
  BEGINNER      // –ù–∞—á–∞–ª—å–Ω—ã–π
  INTERMEDIATE  // –°—Ä–µ–¥–Ω–∏–π
  ADVANCED      // –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
  EXPERT        // –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π
}
```

#### PetType - –¢–∏–ø—ã –ø–∏—Ç–æ–º—Ü–µ–≤
```prisma
enum PetType {
  DOG  // –°–æ–±–∞–∫–∞
  CAT  // –ö–æ—Ç
}
```

## üîß API Reference

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
```typescript
import { prisma } from "@gafus/prisma";

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
const users = await prisma.user.findMany();
```

#### –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = await prisma.user.create({
  data: {
    email: "user@example.com",
    password: "hashedPassword",
    name: "John Doe",
    role: "USER"
  }
});

// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = await prisma.user.findUnique({
  where: { email: "user@example.com" }
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const updatedUser = await prisma.user.update({
  where: { id: userId },
  data: { name: "New Name" }
});
```

#### –†–∞–±–æ—Ç–∞ —Å –∫—É—Ä—Å–∞–º–∏
```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ —Å –¥–Ω—è–º–∏ –∏ —à–∞–≥–∞–º–∏
const courses = await prisma.course.findMany({
  include: {
    days: {
      include: {
        steps: true
      }
    }
  }
});

// –°–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—Å–∞
const course = await prisma.course.create({
  data: {
    name: "–ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å",
    type: "basic",
    description: "–û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞",
    trainingLevel: "BEGINNER"
  }
});
```

#### –†–∞–±–æ—Ç–∞ —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º–∏
```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
const training = await prisma.training.create({
  data: {
    userId: "user_id",
    courseId: "course_id",
    status: "NOT_STARTED"
  }
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
const updatedTraining = await prisma.training.update({
  where: { id: trainingId },
  data: { 
    status: "IN_PROGRESS",
    startedAt: new Date()
  }
});
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –í package.json –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
{
  "dependencies": {
    "@gafus/prisma": "workspace:*"
  }
}
```

### –ò–º–ø–æ—Ä—Ç –∫–ª–∏–µ–Ω—Ç–∞
```typescript
import { prisma } from "@gafus/prisma";

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ API routes
export async function GET() {
  const users = await prisma.user.findMany();
  return Response.json(users);
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Server Components
```typescript
import { prisma } from "@gafus/prisma";

export default async function UsersPage() {
  const users = await prisma.user.findMany({
    select: {
      id: true,
      name: true,
      email: true,
      role: true
    }
  });
  
  return (
    <div>
      {users.map(user => (
        <div key={user.id}>{user.name}</div>
      ))}
    </div>
  );
}
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏–∏

### –ö–æ–º–∞–Ω–¥—ã –º–∏–≥—Ä–∞—Ü–∏–π
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
pnpm db:migrate

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω
pnpm db:migrate:deploy

# –°–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
pnpm db:push

# –ü—Ä–æ—Å–º–æ—Ç—Ä –º–∏–≥—Ä–∞—Ü–∏–π
pnpm db:studio
```

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è schema.prisma
pnpm db:migrate

# Prisma —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏
# migrations/20240101120000_add_new_field/migration.sql
```

### –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π
```bash
# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate reset

# –û—Ç–∫–∞—Ç –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate resolve --rolled-back "migration_name"
```

## üå± Seed –¥–∞–Ω–Ω—ã–µ

### –ó–∞–ø—É—Å–∫ seed
```bash
pnpm db:seed
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ seed.ts
```typescript
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function main() {
  // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  const user = await prisma.user.create({
    data: {
      email: "test@example.com",
      password: "hashedPassword",
      name: "Test User",
      role: "USER"
    }
  });
  
  // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫—É—Ä—Å–æ–≤
  const course = await prisma.course.create({
    data: {
      name: "–¢–µ—Å—Ç–æ–≤—ã–π –∫—É—Ä—Å",
      type: "test",
      description: "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫—É—Ä—Å–∞",
      trainingLevel: "BEGINNER"
    }
  });
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ö–µ–º—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤—è–∑–µ–π

### –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏
- Connection pooling
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ò–Ω–¥–µ–∫—Å—ã
```prisma
model User {
  id    String @id @default(cuid())
  email String @unique  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å
  phone String @unique  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å
  
  @@index([role])       // –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
  @@index([createdAt])  // –ò–Ω–¥–µ–∫—Å –ø–æ –¥–∞—Ç–µ
}
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
```typescript
// –ü–ª–æ—Ö–æ - N+1 –ø—Ä–æ–±–ª–µ–º–∞
const users = await prisma.user.findMany();
for (const user of users) {
  const trainings = await prisma.training.findMany({
    where: { userId: user.id }
  });
}

// –•–æ—Ä–æ—à–æ - –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —Å include
const users = await prisma.user.findMany({
  include: {
    trainings: true
  }
});
```

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è
```typescript
const users = await prisma.user.findMany({
  skip: 0,
  take: 10,
  orderBy: { createdAt: 'desc' }
});
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```typescript
import { prisma } from "@gafus/prisma";

describe("Prisma Package", () => {
  beforeEach(async () => {
    // –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    await prisma.user.deleteMany();
  });
  
  test("should create user", async () => {
    const user = await prisma.user.create({
      data: {
        email: "test@example.com",
        password: "password",
        name: "Test User"
      }
    });
    
    expect(user.email).toBe("test@example.com");
  });
});
```

### Integration —Ç–µ—Å—Ç—ã
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ seed –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
```typescript
const prisma = new PrismaClient({
  log: ['query', 'info', 'warn', 'error'],
});
```

### –ú–µ—Ç—Ä–∏–∫–∏
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Health checks
```typescript
export async function healthCheck() {
  try {
    await prisma.$queryRaw`SELECT 1`;
    return { status: 'healthy' };
  } catch (error) {
    return { status: 'unhealthy', error };
  }
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL="postgresql://username:password@localhost:5432/gafus"

# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
DATABASE_URL="postgresql://username:password@prod-host:5432/gafus?sslmode=require"
```

### Prisma –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```prisma
generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –°–±–æ—Ä–∫–∞
```bash
pnpm build
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
```bash
pnpm db:generate
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
```bash
pnpm db:migrate:deploy
```

### Seed –¥–∞–Ω–Ω—ã—Ö
```bash
pnpm db:seed
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Prisma
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏
- –ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

### –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
