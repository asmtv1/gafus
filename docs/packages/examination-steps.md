# –≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–µ —à–∞–≥–∏ (@gafus/examination-steps)

## üìã –û–±–∑–æ—Ä

–≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–µ —à–∞–≥–∏ ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø —à–∞–≥–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ GAFUS, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞–Ω–∏–π –∏ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö —à–∞–≥–æ–≤, —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–Ω–µ—Ä–æ–º.

## üéØ –¢–∏–ø—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤

–≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏:

### 1. **–¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã** (`hasTestQuestions`)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç—Ä–µ–Ω–µ—Ä–∞ –∫ –∫–∞–∂–¥–æ–º—É –≤–æ–ø—Ä–æ—Å—É (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞, –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)

### 2. **–ü–∏—Å—å–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** (`requiresWrittenFeedback`)
- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
- –ú–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç—Ä–µ–Ω–µ—Ä–æ–º –≤—Ä—É—á–Ω—É—é

### 3. **–í–∏–¥–µ–æ –æ—Ç—á—ë—Ç** (`requiresVideoReport`)
- –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —á–µ—Ä–µ–∑ WebRTC (MediaRecorder API)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–º–µ—Ä—ã –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2 –º–∏–Ω—É—Ç—ã** ‚è±Ô∏è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ (MM:SS)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90% –≤—Ä–µ–º–µ–Ω–∏ (–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Yandex Object Storage (CDN)**
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ —Å –ø—É–±–ª–∏—á–Ω—ã–º URL
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 100 MB
- –§–æ—Ä–º–∞—Ç: WebM (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç—Ä–µ–Ω–µ—Ä–æ–º –≤—Ä—É—á–Ω—É—é

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–ø–∏—Å–∏:**
- Chunks –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É (`mediaRecorder.start(1000)`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useRef` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è chunks (–∏–∑–±–µ–∂–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏)
- –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è blob (–±–µ–∑ `setTimeout`)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Ä–∞–∑–º–µ—Ä chunks, blob URL, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞)

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Step (–≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π)

```prisma
model Step {
  id             String           @id @default(cuid())
  title          String
  description    String
  type           StepType         @default(TRAINING) // EXAMINATION –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–æ–≤
  
  // –ü–æ–ª—è –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
  requiresVideoReport    Boolean  @default(false)  // –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∏–¥–µ–æ –æ—Ç—á—ë—Ç
  requiresWrittenFeedback Boolean @default(false)  // –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–∏—Å—å–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
  hasTestQuestions       Boolean  @default(false)  // –ï—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã
  checklist              Json?    // –ú–∞—Å—Å–∏–≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
  
  stepLinks      StepOnDay[]
  examResults    ExamResult[]
  
  authorId       String
  author         User
  
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @default(now())
}
```

### ExamResult

```prisma
model ExamResult {
  id                    String         @id @default(cuid())
  userStepId           String         @unique
  stepId               String
  
  // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
  testAnswers          Json?           // –û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  testScore            Int?            // –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  testMaxScore         Int?            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤
  
  // –í–∏–¥–µ–æ –æ—Ç—á—ë—Ç
  videoReportUrl       String?         // –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ
  
  // –ü–∏—Å—å–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
  writtenFeedback      String?         // –¢–µ–∫—Å—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
  
  // –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞
  overallScore         Int?            // –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ (–ø—Ä–æ—Ü–µ–Ω—Ç)
  isPassed             Boolean?        // –ü—Ä–æ—à—ë–ª –ª–∏ —ç–∫–∑–∞–º–µ–Ω
  
  userStep             UserStep        @relation(fields: [userStepId], references: [id], onDelete: Cascade)
  step                 Step            @relation(fields: [stepId], references: [id], onDelete: Cascade)
  
  createdAt            DateTime        @default(now())
  updatedAt            DateTime        @updatedAt
}
```

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —ç–∫–∑–∞–º–µ–Ω–∞

### 1. **–°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞ (Trainer Panel)**

```typescript
// –¢—Ä–µ–Ω–µ—Ä —Å–æ–∑–¥–∞–µ—Ç —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥ –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
await createStep({
  title: "–≠–∫–∑–∞–º–µ–Ω –ø–æ –±–∞–∑–æ–≤—ã–º –∫–æ–º–∞–Ω–¥–∞–º",
  description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π –±–∞–∑–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥",
  type: "EXAMINATION",
  requiresVideoReport: true,
  requiresWrittenFeedback: true,
  hasTestQuestions: true,
  checklist: [
    {
      id: "q1",
      question: "–ö–∞–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ —É—á–∏—Ç —Å–æ–±–∞–∫—É —Å–∏–¥–µ—Ç—å?",
      options: ["–°–∏–¥–µ—Ç—å", "–õ–µ–∂–∞—Ç—å", "–°—Ç–æ—è—Ç—å"],
      correctAnswer: 0,
      comment: "–°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Å–ø–æ–∫–æ–π–Ω–æ–π –∏–Ω—Ç–æ–Ω–∞—Ü–∏–∏ –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ –∂–µ—Å—Ç."
    }
  ]
});
```

### 2. **–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞ (Web App)**

#### –°—Ç–∞—Ç—É—Å—ã —à–∞–≥–∞:
- `NOT_STARTED` ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –Ω–∞—á–∞–ª —ç–∫–∑–∞–º–µ–Ω
- `IN_PROGRESS` ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∞–ª –∑–∞–ø–æ–ª–Ω—è—Ç—å —ç–∫–∑–∞–º–µ–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏)
- `COMPLETED` ‚Üí –≠–∫–∑–∞–º–µ–Ω –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω —Ç—Ä–µ–Ω–µ—Ä–æ–º

#### –ü—Ä–æ—Ü–µ—Å—Å:

```typescript
// 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è UserStep —Å NOT_STARTED

// 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
await submitExamResult({
  userStepId: "user-step-id",
  stepId: "step-id",
  testAnswers: { q1: 0, q2: 1 },
  writtenFeedback: "–ú–æ–π –æ—Ç–≤–µ—Ç...",
  videoReportUrl: "https://..."
});
// –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ IN_PROGRESS

// 3. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ ExamResult
// 4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —Å–Ω–æ–≤–∞
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞ (Trainer Panel)**

```typescript
// –¢—Ä–µ–Ω–µ—Ä –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É /main-panel/exam-results
// –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤ –ø–æ —Å–≤–æ–∏–º –∫—É—Ä—Å–∞–º

// –≠–∫–∑–∞–º–µ–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏:
// - "–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏" (IN_PROGRESS) - –∂–µ–ª—Ç—ã–π Chip
// - "–°–¥–∞–Ω" (COMPLETED) - –∑–µ–ª–µ–Ω—ã–π Chip

// –î–ª—è —ç–∫–∑–∞–º–µ–Ω–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏":
// - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–ó–∞—á–µ—Å—Ç—å"
// - –ü—Ä–∏ –∫–ª–∏–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è reviewExamResult

// –¢—Ä–µ–Ω–µ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞—á–µ—Å—Ç—å"
await reviewExamResult({
  userStepId: "user-step-id",
  action: "approve"
});
// 1. –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ COMPLETED
// 2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è "–ó–∞—á—Ç–µ–Ω–æ" –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–∫–∏
// 3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚úÖ
```

### 4. **–ü—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** üîî

–ö–æ–≥–¥–∞ —Ç—Ä–µ–Ω–µ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞—á–µ—Å—Ç—å", —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. **–°–æ–∑–¥–∞—ë—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ `sendImmediatePushNotification`
2. **–î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –≤ pushQueue** —Å `delay: 0`
3. **Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É—à –Ω–∞ –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**
   - –ü—Ä–∏ –∑–∞—á—ë—Ç–µ: –∑–∞–≥–æ–ª–æ–≤–æ–∫ `"[–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞]" –∑–∞—á—Ç—ë–Ω! ‚úÖ`, —Ç–µ–∫—Å—Ç "–¢—Ä–µ–Ω–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏–ª –≤–∞—à —ç–∫–∑–∞–º–µ–Ω. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É."
   - –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏: –∑–∞–≥–æ–ª–æ–≤–æ–∫ `"[–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞]" —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ ‚ùóÔ∏è`, —Ç–µ–∫—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç—Ä–µ–Ω–µ—Ä–∞ –ª–∏–±–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç—á—ë—Ç.
   - –ö–ª–∏–∫ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
```typescript
// packages/webpush/src/immediate-push.ts
const payload = action === "approve"
  ? { title: `"${stepTitle}" –∑–∞—á—Ç—ë–Ω! ‚úÖ`, body: "–¢—Ä–µ–Ω–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏–ª –≤–∞—à —ç–∫–∑–∞–º–µ–Ω. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É." }
  : { title: `"${stepTitle}" —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ ‚ùóÔ∏è`, body: comment ? `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç—Ä–µ–Ω–µ—Ä–∞: ${comment}` : "–¢—Ä–µ–Ω–µ—Ä –≤–µ—Ä–Ω—É–ª —ç–∫–∑–∞–º–µ–Ω –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É." };

await sendImmediatePushNotification({
  userId: userStep.userTraining.userId,
  title: payload.title,
  body: payload.body,
  url: `/trainings/${courseType}/${dayOrder}`
});
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (3 –ø–æ–ø—ã—Ç–∫–∏)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∑–∞—á—ë—Ç–∞
```

## üé® UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#### TestQuestions

```tsx
<TestQuestions
  checklist={checklist}
  userStepId={userStepId}
  stepId={stepId}
  onComplete={(answers) => {}}
  onReset={() => {}}
/>
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- –ü–æ–∫–∞–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

### WrittenFeedback

```tsx
<WrittenFeedback
  userStepId={userStepId}
  stepId={stepId}
  onComplete={(feedback) => {}}
  onReset={() => {}}
/>
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–Ω–æ–≤–æ

### VideoReport

```tsx
<VideoReport
  userStepId={userStepId}
  stepId={stepId}
  onComplete={(videoBlob) => {}}
  onReset={() => {}}
/>
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –≤–∏–¥–µ–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ó–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (WebRTC)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∞—Ç—å –∑–∞–Ω–æ–≤–æ

### Trainer Panel

#### ExamResultsList

```tsx
<ExamResultsList examResults={examResults} />
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤ –ø–æ –∫—É—Ä—Å–∞–º —Ç—Ä–µ–Ω–µ—Ä–∞
- –ê–∫–∫–æ—Ä–¥–µ–æ–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫–∑–∞–º–µ–Ω–∞
- –í–∫–ª–∞–¥–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤:
  - üü° **"–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏"** (IN_PROGRESS) - —ç–∫–∑–∞–º–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω
  - üü¢ **"–°–¥–∞–Ω"** (COMPLETED) - —ç–∫–∑–∞–º–µ–Ω –∑–∞—á—Ç–µ–Ω —Ç—Ä–µ–Ω–µ—Ä–æ–º
- –ö–Ω–æ–ø–∫–∞ **"–ó–∞—á–µ—Å—Ç—å"** –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏"
- –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–ó–∞—á–µ—Å—Ç—å":
  - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ COMPLETED
  - –ö–Ω–æ–ø–∫–∞ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ Chip "–ó–∞—á—Ç–µ–Ω–æ"
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ

#### –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/main-panel/exam-results`

–¢—Ä–µ–Ω–µ—Ä –º–æ–∂–µ—Ç:
1. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ —ç–∫–∑–∞–º–µ–Ω—ã –ø–æ —Å–≤–æ–∏–º –∫—É—Ä—Å–∞–º
2. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–∞—Ç—É—Å—É (—á–µ—Ä–µ–∑ —Ç–∞–±—ã –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã)
3. –í–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ —ç–∫–∑–∞–º–µ–Ω–∞:
   - –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –í–∏–¥–µ–æ –æ—Ç—á—ë—Ç (–ø—Ä–æ—Å–º–æ—Ç—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
   - –ü–∏—Å—å–º–µ–Ω–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
4. –ó–∞—á–∏—Ç—ã–≤–∞—Ç—å —ç–∫–∑–∞–º–µ–Ω—ã –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π
5. –í–∏–¥–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (USER)
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
- ‚úÖ –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚ùå –ü—Ä–æ—Å–º–æ—Ç—Ä —á—É–∂–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚ùå –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–æ–≤

### –¢—Ä–µ–Ω–µ—Ä—ã (TRAINER, MODERATOR)
- ‚úÖ –í—Å–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫–∑–∞–º–µ–Ω–æ–≤ –¥–ª—è —Å–≤–æ–∏—Ö –∫—É—Ä—Å–æ–≤
- ‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–æ–≤ –¥–ª—è —Å–≤–æ–∏—Ö –∫—É—Ä—Å–æ–≤

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (ADMIN)
- ‚úÖ –í—Å–µ –ø—Ä–∞–≤–∞ —Ç—Ä–µ–Ω–µ—Ä–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫–∑–∞–º–µ–Ω–æ–≤
- ‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ª—é–±—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–æ–≤

## üìä API –∏ Server Actions

### Web App

#### `uploadExamVideo(formData: FormData)`
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∏–¥–µ–æ —ç–∫–∑–∞–º–µ–Ω–∞ –Ω–∞ CDN.

```typescript
const formData = new FormData();
formData.append("video", videoFile);

const result = await uploadExamVideo(formData);
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { success: boolean; videoUrl?: string; error?: string }
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –¢–∏–ø —Ñ–∞–π–ª–∞ (`video/*`)
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å 100 MB)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ: 2 –º–∏–Ω—É—Ç—ã** ‚è±Ô∏è

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è: `exam-video-{userId}-{uuid}.webm`
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞ Yandex Object Storage –≤ –ø–∞–ø–∫—É `exam-videos/`
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL: `https://gafus-media.storage.yandexcloud.net/uploads/exam-videos/...`

#### `submitExamResult(data: ExamSubmissionData)`
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫–∑–∞–º–µ–Ω–∞.

```typescript
await submitExamResult({
  userStepId: string,
  stepId: string,
  testAnswers?: Record<string, number>,
  testScore?: number,
  testMaxScore?: number,
  videoReportUrl?: string,  // CDN URL –æ—Ç uploadExamVideo
  writtenFeedback?: string,
  overallScore?: number,
  isPassed?: boolean
});
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç `ExamResult` —á–µ—Ä–µ–∑ `upsert`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `UserStep` ‚Üí `IN_PROGRESS`
- Revalidate path `/trainings`

#### `getExamResult(userStepId: string)`
–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω–∞.

```typescript
const examResult = await getExamResult(userStepId);
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ExamResultData | null
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ userStep –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### Trainer Panel

#### `getPendingExamResults()`
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —ç–∫–∑–∞–º–µ–Ω–æ–≤, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏.

```typescript
const pendingExams = await getPendingExamResults();
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: PendingExamResult[]
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
- –¢–æ–ª—å–∫–æ —ç–∫–∑–∞–º–µ–Ω—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `IN_PROGRESS`
- –î–ª—è TRAINER/MODERATOR: —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∫—É—Ä—Å—ã
- –î–ª—è ADMIN: –≤—Å–µ –∫—É—Ä—Å—ã

#### `reviewExamResult(prevState, formData)`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç/–æ—Ç–∫–ª–æ–Ω—è–µ—Ç —ç–∫–∑–∞–º–µ–Ω.

```typescript
await reviewExamResult(prevState, formData);
// formData: { userStepId, action: "approve"|"reject", trainerComment? }
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- `approve`: —Å—Ç–∞—Ç—É—Å ‚Üí `COMPLETED`, `isPassed` ‚Üí `true`, **–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** üîî
- `reject`: —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è `IN_PROGRESS`, `isPassed` ‚Üí `false`, **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—É—à —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º —Ç—Ä–µ–Ω–µ—Ä–∞** üîî
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä –∫—É—Ä—Å–∞ –∏–ª–∏ –∞–¥–º–∏–Ω)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏:**
```typescript
// –ü—Ä–∏ –∑–∞—á—ë—Ç–µ —ç–∫–∑–∞–º–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—É—à
if (action === "approve") {
  await sendImmediatePushNotification({
    userId: userStep.userTraining.userId,
    title: `"${stepTitle}" –∑–∞—á—Ç—ë–Ω! ‚úÖ`,
    body: `–¢—Ä–µ–Ω–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏–ª –≤–∞—à —ç–∫–∑–∞–º–µ–Ω. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.`,
    url: `/trainings/${courseType}/${dayOrder}`
  });
}
```

## üîî –°–∏—Å—Ç–µ–º–∞ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. **`sendImmediatePushNotification`** (`packages/webpush/src/immediate-push.ts`) - helper –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. **`pushQueue`** (`packages/queues`) - –æ—á–µ—Ä–µ–¥—å BullMQ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
3. **`PushWorker`** (`packages/worker/src/push-worker.ts`) - worker –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
4. **`StepNotification`** (Prisma) - –º–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–¢—Ä–µ–Ω–µ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞—á–µ—Å—Ç—å"
         ‚Üì
reviewExamResult (Server Action)
         ‚Üì
sendImmediatePushNotification
         ‚Üì
–°–æ–∑–¥–∞–Ω–∏–µ StepNotification (delay: 0)
         ‚Üì
pushQueue.add({ notificationId })
         ‚Üì
PushWorker –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É
         ‚Üì
–ó–∞–≥—Ä—É–∂–∞–µ—Ç PushSubscription –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
         ‚Üì
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É—à –Ω–∞ –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
         ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ üîî
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:**
- `delay: 0` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É
- `day: 0, stepIndex: -1` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `stepTitle: "title|body"` - –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `|`
- Worker —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç `stepIndex: -1` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ "–í–´ –í–ï–õ–ò–ö–û–õ–ï–ü–ù–´!"

**2. –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:**
- `attempts: 3` - –¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- `backoff: exponential` - —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
- –û—à–∏–±–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∑–∞—á—ë—Ç–∞

**3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—Å–µ —ç—Ç–∞–ø—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `@gafus/logger`
- –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞: `logger.success`
- –û—à–∏–±–∫–∏: `logger.error` (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

**4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:**
- –ü—É—à –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ iOS (Safari PWA), Android (Chrome), Desktop

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –í –ª—é–±–æ–º Server Action
import { sendImmediatePushNotification } from "@gafus/webpush";

await sendImmediatePushNotification({
  userId: "user-id",
  title: "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
  body: "–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
  url: "/–ø—É—Ç—å/–∫—É–¥–∞/–ø–µ—Ä–µ–π—Ç–∏",
  icon: "/icons/icon192.png",
  badge: "/icons/badge-72.png"
});
```

## üéØ Best Practices

### –î–ª—è —Ç—Ä–µ–Ω–µ—Ä–æ–≤

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤**
   - –ß–µ—Ç–∫–æ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å
   - –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤ –æ–ø–∏—Å–∞–Ω–∏–∏

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫–∑–∞–º–µ–Ω–æ–≤**
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —ç–∫–∑–∞–º–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24-48 —á–∞—Å–æ–≤
   - –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤" –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –≤—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–µ—Ä–µ–¥ –ø—Ä–∏–Ω—è—Ç–∏–µ–º —Ä–µ—à–µ–Ω–∏—è:
     - –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π)
     - –ü–∏—Å—å–º–µ–Ω–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
     - –í–∏–¥–µ–æ –æ—Ç—á—ë—Ç—ã
   - –ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞—á–µ—Å—Ç—å" —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω–∏–ª –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
   - –ë—É–¥—å—Ç–µ –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã –∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã

3. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã
   - –¢–µ—Å—Ç—ã ‚Äî –¥–ª—è –∑–Ω–∞–Ω–∏–π
   - –ü–∏—Å—å–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å ‚Äî –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
   - –í–∏–¥–µ–æ ‚Äî –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Prisma —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ö—ç—à–∏—Ä—É–π—Ç–µ ExamResult –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `revalidatePath` –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `include`

3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**
   - –ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
   - –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üì∏ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ "–≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —à–∞–≥" –≤–º–µ—Å—Ç–æ —Ç–∞–π–º–µ—Ä–∞
- –†–∞–∑–¥–µ–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - **–¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã** - Radio buttons —Å –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–æ–π
  - **–ü–∏—Å—å–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - TextField —Å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–∞–º–∏
  - **–í–∏–¥–µ–æ –æ—Ç—á—ë—Ç** - –ó–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ –≤–µ–±-–∫–∞–º–µ—Ä—É:
    - ‚è±Ô∏è –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞: `0:00 / 2:00`
    - üî¥ –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90% –≤—Ä–µ–º–µ–Ω–∏ (1:48)
    - ‚èπÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã
    - üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
    - ‚òÅÔ∏è –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä..." –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- –ö–Ω–æ–ø–∫–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
- –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è: "–û–∂–∏–¥–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–µ—Ä–æ–º"
- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–Ω–æ–≤–∞

### Trainer Panel (–¢—Ä–µ–Ω–µ—Ä)

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/main-panel/exam-results`:**
- **–ê–∫–∫–æ—Ä–¥–µ–æ–Ω —Å–ø–∏—Å–æ–∫** –≤—Å–µ—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞:**
  - –ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞
  - –ö—É—Ä—Å - –î–µ–Ω—å - –®–∞–≥
  - Chips —Å —Ç–∏–ø–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–¢–µ—Å—Ç, –í–∏–¥–µ–æ, –ü–∏—Å—å–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
  - Chip —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º ("–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏" / "–°–¥–∞–Ω")
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞:**
  - **–í–∫–ª–∞–¥–∫–∏** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
  - **–í–∫–ª–∞–¥–∫–∞ "–¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã":**
    - –ë–∞–ª–ª—ã: X –∏–∑ Y
    - –°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –≤—ã–¥–µ–ª–µ–Ω—ã ‚úì
    - –ó–µ–ª–µ–Ω–∞—è/–∫—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  - **–í–∫–ª–∞–¥–∫–∞ "–í–∏–¥–µ–æ –æ—Ç—á—ë—Ç":**
    - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä
    - –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ"
  - **–í–∫–ª–∞–¥–∫–∞ "–ü–∏—Å—å–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞":**
    - –¢–µ–∫—Å—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - **–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏** —ç–∫–∑–∞–º–µ–Ω–∞
  - **–ö–Ω–æ–ø–∫–∞ "–ó–∞—á–µ—Å—Ç—å"** (–∑–µ–ª–µ–Ω–∞—è) - —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ "–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏"
  - **Chip "–ó–∞—á—Ç–µ–Ω–æ"** (–∑–µ–ª–µ–Ω—ã–π, outlined) - –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ "–°–¥–∞–Ω"

## üêõ Troubleshooting

### –≠–∫–∑–∞–º–µ–Ω –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—è —ç–∫–∑–∞–º–µ–Ω–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `type = "EXAMINATION"` –≤ –ë–î
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–ª–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `true`:
   - `hasTestQuestions`
   - `requiresWrittenFeedback`
   - `requiresVideoReport`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `userStepId` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ console –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏

### –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —ç–∫–∑–∞–º–µ–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—è –ø—É—Å—Ç—ã–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `submitExamResult` —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `ExamResult`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `getExamResult` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ network tab –≤ DevTools

### –¢—Ä–µ–Ω–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —É—Ç–≤–µ—Ä–¥–∏—Ç—å —ç–∫–∑–∞–º–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞" –ø—Ä–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —ç–∫–∑–∞–º–µ–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–µ—Å—Å–∏–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫—É—Ä—Å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç—Ä–µ–Ω–µ—Ä—É (`course.authorId === trainer.id`)
3. –î–ª—è ADMIN –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∞ –∫—É—Ä—Å–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `trainer-panel-review-exam`

### –°—Ç–∞—Ç—É—Å —à–∞–≥–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —ç–∫–∑–∞–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è `IN_PROGRESS`.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `reviewExamResult` –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î —Å—Ç–∞—Ç—É—Å `UserStep`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `revalidatePath("/trainings")` –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ (Ctrl+F5)

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

1. **–î–ª—è —Ç—Ä–µ–Ω–µ—Ä–æ–≤:**
   - –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —ç–∫–∑–∞–º–µ–Ω–æ–≤
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–∫–∑–∞–º–µ–Ω–æ–≤
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–æ —É—Å–ø–µ—à–Ω–æ–π —Å–¥–∞—á–∏

2. **–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–∞–º–µ–Ω–æ–≤
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–∞–º–µ–Ω–æ–≤, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ —ç–∫–∑–∞–º–µ–Ω–∞–º

3. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
   - –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–∞
   - –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —ç–∫–∑–∞–º–µ–Ω–æ–≤

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –í–µ—Ä—Å–∏—è 2.5.3 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - —É–ª—É—á—à–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- ‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —Ç–∏–ø—ã** - —É–±—Ä–∞–Ω—ã magic numbers, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ **JSDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –≤—Å–µ –º–µ—Ç–æ–¥—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **–õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –∫–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º

### –í–µ—Ä—Å–∏—è 2.5.2 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - —É–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ—Ñ–∏–∫—Å "–í–´ –í–ï–õ–ò–ö–û–õ–ï–ü–ù–´!" –∏ "–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏"
- ‚úÖ **–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - worker —Ç–µ–ø–µ—Ä—å —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç stepIndex: -1 –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π title/body
- ‚úÖ **–ß–∏—Å—Ç—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞—à —Ç–µ–∫—Å—Ç –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤

### –í–µ—Ä—Å–∏—è 2.5.1 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–£–ª—É—á—à–µ–Ω —Ç–µ–∫—Å—Ç –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - —É–±—Ä–∞–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å
- ‚úÖ **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `"[–ù–∞–∑–≤–∞–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞]" –∑–∞—á—Ç—ë–Ω! ‚úÖ` - –ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ —ç–∫–∑–∞–º–µ–Ω
- ‚úÖ **–¢–µ–∫—Å—Ç:** `"–¢—Ä–µ–Ω–µ—Ä –ø—Ä–æ–≤–µ—Ä–∏–ª –≤–∞—à —ç–∫–∑–∞–º–µ–Ω. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É."` - –ª–∞–∫–æ–Ω–∏—á–Ω–æ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ

### –í–µ—Ä—Å–∏—è 2.5 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞—á—ë—Ç–µ —ç–∫–∑–∞–º–µ–Ω–∞** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–≥–¥–∞ —Ç—Ä–µ–Ω–µ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞—á—Ç–µ–Ω–æ"
- ‚úÖ **–°–æ–∑–¥–∞–Ω helper sendImmediatePushNotification** - –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å reviewExamResult** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—É—à–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞—á—ë—Ç–µ
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—É—à–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∑–∞—á—ë—Ç–∞

### –í–µ—Ä—Å–∏—è 2.4 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ç—Ä–µ–Ω–µ—Ä –ø–∞–Ω–µ–ª–∏** - —É–¥–∞–ª–µ–Ω–∞ batch upload –ª–æ–≥–∏–∫–∞ (86 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
- ‚úÖ **–ü—Ä–∏–º–µ–Ω—ë–Ω –µ–¥–∏–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç `experimental.serverActions.bodySizeLimit: '100mb'`
- ‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö, –∞—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω bodySizeLimit –≤ trainer-panel** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `apps/trainer-panel/next.config.ts`

### –í–µ—Ä—Å–∏—è 2.3 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ 413 Request Entity Too Large** - –Ω–∞–π–¥–µ–Ω–∞ –∫–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ **Next.js 15 Server Actions** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª—é—á–µ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `experimental.serverActions.bodySizeLimit: '100mb'`
- ‚úÖ **nginx (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏ production)** - —É–≤–µ–ª–∏—á–µ–Ω—ã –ª–∏–º–∏—Ç—ã `client_max_body_size 100M` –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–µ–æ** - —Å–Ω–∏–∂–µ–Ω –±–∏—Ç—Ä–µ–π—Ç –¥–æ 300kbps (–≤–∏–¥–µ–æ) –∏ 48kbps (–∞—É–¥–∏–æ) –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (~40% —ç–∫–æ–Ω–æ–º–∏—è)
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–º–∞–∫—Å–∏–º—É–º 50MB) —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- ‚úÖ **–£–ª—É—á—à–µ–Ω UI** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ —Ñ–∞–π–ª–∞, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞, –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ **–û–±–Ω–æ–≤–ª—ë–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π nginx** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–∏–≥ `/opt/homebrew/etc/nginx/servers/gafus-localhost.conf`
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –í–µ—Ä—Å–∏—è 2.2 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é –æ—Ç—á–µ—Ç–æ–≤** - —Ç–µ–ø–µ—Ä—å –≤—Å–µ —Ç–∏–ø—ã –æ—Ç—á–µ—Ç–æ–≤ (—Ç–µ—Å—Ç, –≤–∏–¥–µ–æ, –ø–∏—Å—å–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- ‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ submitExamResult** - –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** - –≤ –ø–∞–Ω–µ–ª–∏ —Ç—Ä–µ–Ω–µ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ —Ç–∏–ø—ã –æ—Ç—á–µ—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –í–µ—Ä—Å–∏—è 2.1 (–î–µ–∫–∞–±—Ä—å 2024)
- ‚úÖ **–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –≤–∏–¥–µ–æ** - –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ production
- ‚úÖ **–£–±—Ä–∞–Ω—ã –≤—Å–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã** - —É–¥–∞–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ **–û—á–∏—â–µ–Ω –∫–æ–¥ –æ—Ç console.log** - —É–±—Ä–∞–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ production –∫–æ–¥–∞
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–∏–¥–µ–æ

### –í–µ—Ä—Å–∏—è 2.0 (–û–∫—Ç—è–±—Ä—å 2025)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `UserStep` –∑–∞–ø–∏—Å–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –°—Ç–∞—Ç—É—Å `IN_PROGRESS` –¥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–Ω–µ—Ä–æ–º (–≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ `COMPLETED`)
- ‚úÖ –£–±—Ä–∞–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ "–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 100%" –≤ Trainer Panel
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ **"–ó–∞—á–µ—Å—Ç—å"** –¥–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —ç–∫–∑–∞–º–µ–Ω–æ–≤
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
  - üü° "–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏" –¥–ª—è `IN_PROGRESS`
  - üü¢ "–°–¥–∞–Ω" –¥–ª—è `COMPLETED`
- ‚úÖ –ü–æ—Å–ª–µ –∑–∞—á–µ—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è Chip "–ó–∞—á—Ç–µ–Ω–æ"

**–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `getExamResult()` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–∞ (Web App)
- `uploadExamVideo()` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –Ω–∞ CDN (Web App) üé•
- `reviewExamResult()` - —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞ —Ç—Ä–µ–Ω–µ—Ä–æ–º (Trainer Panel)
- `getPendingExamResults()` - —Å–ø–∏—Å–æ–∫ —ç–∫–∑–∞–º–µ–Ω–æ–≤ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É (Trainer Panel)

**–£–ª—É—á—à–µ–Ω–∏—è UX:**
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–æ–æ–±—â–µ–Ω–∏—è "–û–∂–∏–¥–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–µ—Ä–æ–º" –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –∑–∞—á–µ—Ç–∞
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞—á–µ—Ç–∞ (disabled —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏)
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä..." –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–∏–¥–µ–æ
- –ò–∫–æ–Ω–∫–∞ CloudUpload –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

**–•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ:**

**–ó–∞–ø–∏—Å—å:**
- üé• –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ —á–µ—Ä–µ–∑ MediaRecorder API (WebRTC)
- ‚è±Ô∏è **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2 –º–∏–Ω—É—Ç—ã (120 —Å–µ–∫—É–Ω–¥)**
- ‚èπÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- üî¥ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90% –≤—Ä–µ–º–µ–Ω–∏ (1:48)

**–°–∂–∞—Ç–∏–µ:**
- üóúÔ∏è **–ö–æ–¥–µ–∫ VP9** (–ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ) —Å fallback –Ω–∞ VP8
- üìπ **–í–∏–¥–µ–æ –±–∏—Ç—Ä–µ–π—Ç: 500 kbps** (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ/—Ä–∞–∑–º–µ—Ä)
- üéµ **–ê—É–¥–∏–æ –±–∏—Ç—Ä–µ–π—Ç: 64 kbps** (—á–∏—Å—Ç—ã–π –∑–≤—É–∫)
- üì¶ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä:** ~7-10 MB –∑–∞ 2 –º–∏–Ω—É—Ç—ã
- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**
- ‚òÅÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ Yandex Object Storage
- üîó –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π CDN URL –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- üìÇ –ü–∞–ø–∫–∞: `exam-videos/`
- üåê URL: `https://gafus-media.storage.yandexcloud.net/uploads/exam-videos/exam-video-{userId}-{uuid}.webm`
- üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: 1 –≥–æ–¥ (`max-age=31536000`)
- ‚úÖ –í–∏–¥–µ–æ –¥–æ—Å—Ç—É–ø–Ω–æ —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–ü–æ–ª–∏—Ç–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (—ç–∫–æ–Ω–æ–º–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞):**

1. **–ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏** (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):
   - –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ —Å—Ç–∞—Ä–æ–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –ü—Ä–∏—á–∏–Ω–∞: `replaced`
   - –≠–∫–æ–Ω–æ–º–∏—è: ~50% –º–µ—Å—Ç–∞

2. **–ó–∞—á—Ç–µ–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã** (—á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π):
   - –°—Ç–∞—Ç—É—Å: `COMPLETED`
   - –£–¥–∞–ª–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∑–∞—á–µ—Ç–∞
   - –ü—Ä–∏—á–∏–Ω–∞: `auto_cleanup_completed`
   - –¶–µ–ª—å: –∞—Ä—Ö–∏–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∞–ø–µ–ª–ª—è—Ü–∏–π

3. **–ù–µ–∑–∞—á—Ç–µ–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã** (—á–µ—Ä–µ–∑ 90 –¥–Ω–µ–π):
   - –°—Ç–∞—Ç—É—Å: `IN_PROGRESS`
   - –£–¥–∞–ª–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 90 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
   - –ü—Ä–∏—á–∏–Ω–∞: `auto_cleanup_pending`
   - –¶–µ–ª—å: –æ—á–∏—Å—Ç–∫–∞ –±—Ä–æ—à–µ–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞:**
- üïê –ó–∞–ø—É—Å–∫: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 MSK (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)
- ü§ñ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è: BullMQ Worker —Å cron schedule
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –≤—Å–µ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –ø—Ä–∏—á–∏–Ω–æ–π
- üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: admin –ø–∞–Ω–µ–ª—å `/main-panel/admin`
- üí∞ –≠–∫–æ–Ω–æ–º–∏—è: ~93% –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –í–∏–¥–µ–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- Chunks –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Blob —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º
- –ù–æ –≤–∏–¥–µ–æ —ç–ª–µ–º–µ–Ω—Ç –æ—Å—Ç–∞–µ—Ç—Å—è —á–µ—Ä–Ω—ã–º –∏–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:**
–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–µ–º, —á—Ç–æ `mediaRecorder.start()` –≤—ã–∑—ã–≤–∞–ª—Å—è –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –æ–¥–Ω–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ chunk –≤ –∫–æ–Ω—Ü–µ –∑–∞–ø–∏—Å–∏. –≠—Ç–æ –º–æ–≥–ª–æ –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤–∏–¥–µ–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
1. **–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ `mediaRecorder.start(1000)`** - —ç—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç MediaRecorder –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å chunks –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
2. **–£–±—Ä–∞—Ç—å `setTimeout` –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è** - –ø—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–µ–µ
3. **–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º

**–ö–æ–¥ –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```typescript
mediaRecorder.start(); // ‚ùå –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
setTimeout(() => {
  setRecordedVideo(videoUrl); // ‚ùå –ß–µ—Ä–µ–∑ setTimeout
}, 100);
```

**–ö–æ–¥ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```typescript
mediaRecorder.start(1000); // ‚úÖ Chunks –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
setRecordedVideo(videoUrl); // ‚úÖ –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–Ω HTML —Ç–µ—Å—Ç (`debug-video.html`) –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã
2. –°–æ–∑–¥–∞–Ω debug –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (`VideoReportDebug.tsx`) —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í–∏–¥–µ–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Chunks –ø–æ–ª—É—á–∞—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ (–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
- ‚úÖ Blob URL —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ video —ç–ª–µ–º–µ–Ω—Ç—É
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

### –ü—Ä–æ–±–ª–µ–º–∞: "Infinity —Å–µ–∫—É–Ω–¥" –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í–∏–¥–µ–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
- –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `duration: Infinity`

**–ü—Ä–∏—á–∏–Ω–∞:**
WebM —Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:**
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è WebM, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —á–µ—Ä–µ–∑ MediaRecorder. –í–∏–¥–µ–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ—Å—Ç–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏. –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

### –ü—Ä–æ–±–ª–µ–º–∞: –ß–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (chunks –ø–æ–ª—É—á–∞—é—Ç—Å—è, blob —Å–æ–∑–¥–∞–µ—Ç—Å—è)
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (`onLoadedMetadata` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç)
- –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é (`onCanPlay` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç)
- –ù–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è - —á–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω
- –ü—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É - —Ñ–∞–π–ª –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:**
–ü—Ä–æ–±–ª–µ–º–∞ —Å–≤—è–∑–∞–Ω–∞ —Å **—É—Å–ª–æ–≤–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º** `<video>` —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ React. –ö–æ–≥–¥–∞ `mediaRecorder.onstop` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ –ø—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `src` —á–µ—Ä–µ–∑ `ref`, —ç–ª–µ–º–µ–Ω—Ç –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DOM, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**–ö–ª—é—á–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: —ç–ª–µ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ª–æ–≤–Ω–æ
{recordedVideo ? <video ref={ref} /> : <div>–ù–µ—Ç –≤–∏–¥–µ–æ</div>}

// –í –º–æ–º–µ–Ω—Ç onstop:
recordedVideoRef.current // null! –≠–ª–µ–º–µ–Ω—Ç–∞ –µ—â–µ –Ω–µ—Ç –≤ DOM
```

**–†–µ—à–µ–Ω–∏–µ:**
1. **üîë –ö–õ–Æ–ß–ï–í–û–ï: –°–æ–∑–¥–∞–≤–∞—Ç—å `<video>` —ç–ª–µ–º–µ–Ω—Ç –í–°–ï–ì–î–ê** - –Ω–µ —É—Å–ª–æ–≤–Ω–æ!
2. **–°–∫—Ä—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ `display: none`** –≤–º–µ—Å—Ç–æ —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
3. **–î–æ–±–∞–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç `playsInline`** - –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
4. **–ò–∑–º–µ–Ω–∏—Ç—å `preload` –Ω–∞ `"auto"`** - –ø–æ–ª–Ω–∞—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ
5. **–î–æ–±–∞–≤–∏—Ç—å `minHeight`** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤–∏–¥–µ–æ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä—ã
6. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å `src` –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ DOM** —á–µ—Ä–µ–∑ useEffect

**–ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```typescript
// –î–æ–±–∞–≤–ª—è–µ–º ref –¥–ª—è –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
const recordedVideoRef = useRef<HTMLVideoElement | null>(null);

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ recordedVideo
useEffect(() => {
  if (recordedVideo && recordedVideoRef.current) {
    console.log('üé¨ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–µ–æ –≤ —ç–ª–µ–º–µ–Ω—Ç');
    
    // üîë –ö–õ–Æ–ß–ï–í–û–ï: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º src –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ DOM (–∫–∞–∫ –≤ HTML —Ç–µ—Å—Ç–µ)
    recordedVideoRef.current.src = recordedVideo;
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º
    recordedVideoRef.current.load();
    
    console.log('‚úÖ –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ —ç–ª–µ–º–µ–Ω—Ç');
  }
}, [recordedVideo]);

// –í JSX - video —ç–ª–µ–º–µ–Ω—Ç –í–°–ï–ì–î–ê –≤ DOM, —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ display
return (
  <div>
    {/* Video —ç–ª–µ–º–µ–Ω—Ç –í–°–ï–ì–î–ê —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DOM */}
    <video
      ref={recordedVideoRef}
      controls
      playsInline
      preload="auto"
      style={{ 
        display: recordedVideo ? "block" : "none", // ‚úÖ –°–∫—Ä—ã–≤–∞–µ–º, –∞ –Ω–µ —É–¥–∞–ª—è–µ–º
        width: "100%", 
        maxWidth: "400px", 
        minHeight: "300px",
        height: "auto",
        borderRadius: "8px",
        backgroundColor: "#000"
      }}
    />
    
    <Card>
      {/* –û—Å—Ç–∞–ª—å–Ω–æ–π UI */}
    </Card>
  </div>
);
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. **Video —ç–ª–µ–º–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –≤ DOM** - `ref` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç `null`
2. **–ü—Ä—è–º–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `src` —á–µ—Ä–µ–∑ DOM** - –∫–∞–∫ –≤ HTML —Ç–µ—Å—Ç–µ
3. **–°–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ CSS** - –Ω–µ —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
4. **–ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É blob URL

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã:**
```
üì¶ –í—Å–µ–≥–æ chunks: 0  ‚ùå Chunks –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
üé• Blob: 0 –±–∞–π—Ç     ‚ùå Blob –ø—É—Å—Ç–æ–π
‚ùå recordedVideoRef.current is null!  ‚ùå –≠–ª–µ–º–µ–Ω—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```
–≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ.

**–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
1. **–°–æ–∑–¥–∞–≤–∞—Ç—å video —ç–ª–µ–º–µ–Ω—Ç –í–°–ï–ì–î–ê** (–Ω–µ —É—Å–ª–æ–≤–Ω–æ)
2. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å `src` –Ω–∞–ø—Ä—è–º—É—é –≤ `mediaRecorder.onstop`** (–∫–∞–∫ –≤ HTML —Ç–µ—Å—Ç–µ)
3. **–í—ã–∑—ã–≤–∞—Ç—å `.load()` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `src`**

```typescript
// –í mediaRecorder.onstop:
const videoUrl = URL.createObjectURL(blob);

// –ü–†–Ø–ú–ê–Ø —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ DOM (–∫–∞–∫ –≤ —Ä–∞–±–æ—á–µ–º —Ç–µ—Å—Ç–µ)
if (recordedVideoRef.current) {
  recordedVideoRef.current.src = videoUrl;
  recordedVideoRef.current.load();
  
  setRecordedVideo(videoUrl); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í–∏–¥–µ–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (desktop, mobile)  
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö (Chrome, Firefox, Safari)
- ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ production

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ 413 Request Entity Too Large

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û** (–î–µ–∫–∞–±—Ä—å 2024)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–∏–¥–µ–æ —ç–∫–∑–∞–º–µ–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ `413 Request Entity Too Large`
- –ó–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í–∏–¥–µ–æ —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ CDN

**–ü—Ä–∏—á–∏–Ω–∞:**
–†–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ —Ñ–∞–π–ª–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞:
1. **nginx** - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `client_max_body_size 1M` (—Ç–æ–ª—å–∫–æ 1MB)
2. **Next.js** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ** - –≤—ã—Å–æ–∫–∏–π –±–∏—Ç—Ä–µ–π—Ç (500kbps) —Å–æ–∑–¥–∞–≤–∞–ª –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ nginx** - —É–≤–µ–ª–∏—á–µ–Ω—ã –ª–∏–º–∏—Ç—ã –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤:
```nginx
client_max_body_size 100M;
client_body_timeout 60s;
client_header_timeout 60s;
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Next.js** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Server Actions (Next.js 15+):
```typescript
experimental: {
  serverActions: {
    bodySizeLimit: '100mb', // –ö–õ–Æ–ß–ï–í–ê–Ø –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ Server Actions
  },
},
serverRuntimeConfig: {
  maxFileSize: 100 * 1024 * 1024, // 100MB
},
publicRuntimeConfig: {
  maxFileSize: 100 * 1024 * 1024, // 100MB
}
```

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ** - —Å–Ω–∏–∂–µ–Ω –±–∏—Ç—Ä–µ–π—Ç:
```typescript
// –ë—ã–ª–æ: 500kbps –≤–∏–¥–µ–æ, 64kbps –∞—É–¥–∏–æ
// –°—Ç–∞–ª–æ: 300kbps –≤–∏–¥–µ–æ, 48kbps –∞—É–¥–∏–æ
videoBitsPerSecond: 300000,
audioBitsPerSecond: 48000
```

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞:
```typescript
const maxFileSize = 50 * 1024 * 1024; // 50MB
if (blob.size > maxFileSize) {
  throw new Error(`–†–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç 50MB`);
}
```

5. **UI —É–ª—É—á—à–µ–Ω–∏—è** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:
- –ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 50MB
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

6. **–õ–æ–∫–∞–ª—å–Ω—ã–π nginx (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```nginx
# –í /opt/homebrew/etc/nginx/servers/gafus-localhost.conf
server {
    listen 80;
    server_name web.gafus.localhost;
    
    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–∏–º–∏—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (–≤–∏–¥–µ–æ)
    client_max_body_size 100M;
    client_body_timeout 60s;
    client_header_timeout 60s;
    
    location / {
        proxy_pass http://127.0.0.1:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏
        
        # –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è dev —Ä–µ–∂–∏–º–∞
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

**–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ nginx –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–≥–æ:
```bash
nginx -t  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx -s reload  # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**–ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏ 413 –Ω–∞ –ª–æ–∫–∞–ª–∏:**
- –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω `web.gafus.localhost` –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ homebrew nginx
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `client_max_body_size` = 1MB –≤ nginx
- Server Actions –≤ Next.js 15 —Ç—Ä–µ–±—É—é—Ç `experimental.serverActions.bodySizeLimit`
- –ë–µ–∑ —ç—Ç–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∑–∞–ø—Ä–æ—Å—ã >1MB –æ—Ç–∫–ª–æ–Ω—è–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π 413

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í–∏–¥–µ–æ –¥–æ 50MB –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (–ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
- ‚úÖ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ —É–º–µ–Ω—å—à–µ–Ω –Ω–∞ ~40% –±–ª–∞–≥–æ–¥–∞—Ä—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ —Ñ–∞–π–ª–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –û—à–∏–±–∫–∞ 413 –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π batch upload –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û** (–î–µ–∫–∞–±—Ä—å 2024)

**–ü—Ä–æ–±–ª–µ–º–∞:**
–í —Ç—Ä–µ–Ω–µ—Ä –ø–∞–Ω–µ–ª–∏ (`NewStepForm.tsx`) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π batch upload –ø–æ–¥—Ö–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
- –§–∞–π–ª—ã —Ä–∞–∑–±–∏–≤–∞–ª–∏—Å—å –Ω–∞ –ø–æ—Ä—Ü–∏–∏ –ø–æ 5 —à—Ç—É–∫
- –ü–µ—Ä–≤–∞—è –ø–æ—Ä—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞—Å—å, –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ `setTimeout` –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞—Å—å –≤—Ç–æ—Ä–∞—è
- –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ `isUploadingRemaining`, `maxFilesPerRequest`
- 86+ —Å—Ç—Ä–æ–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞

**–ó–∞—á–µ–º —ç—Ç–æ –±—ã–ª–æ –Ω—É–∂–Ω–æ:**
–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –±—ã–ª —Å–æ–∑–¥–∞–Ω –∫–∞–∫ workaround –¥–ª—è –æ–±—Ö–æ–¥–∞ –ª–∏–º–∏—Ç–∞ 1MB –≤ Next.js 14/15 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

**–ü–æ—á–µ–º—É —É—Å—Ç–∞—Ä–µ–ª:**
–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `experimental.serverActions.bodySizeLimit: '100mb'`:
- –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ 100MB –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
- 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π √ó 1-2MB = ~10-20MB - –¥–∞–ª–µ–∫–æ –Ω–∏–∂–µ –ª–∏–º–∏—Ç–∞
- Batch upload —Å—Ç–∞–ª –∏–∑–±—ã—Ç–æ—á–Ω—ã–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏–ª–∏ `experimental.serverActions.bodySizeLimit: '100mb'` –≤ `apps/trainer-panel/next.config.ts`
2. –£–¥–∞–ª–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `maxFilesPerRequest` –∏ `isUploadingRemaining`
3. –£–¥–∞–ª–∏–ª–∏ –≤—Å—é –ª–æ–≥–∏–∫—É —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ü–∏–∏ (86 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
4. –£–ø—Ä–æ—Å—Ç–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫—É –¥–æ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```typescript
// ‚ùå –ë–´–õ–û: –°–ª–æ–∂–Ω–∞—è batch –ª–æ–≥–∏–∫–∞
const filesToUpload = imageFiles.slice(0, maxFilesPerRequest);
filesToUpload.forEach((file, index) => {
  formData.append("images", file, fileName);
});
// ... –∑–∞—Ç–µ–º setTimeout –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ñ–∞–π–ª–æ–≤

// ‚úÖ –°–¢–ê–õ–û: –ü—Ä–æ—Å—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
imageFiles.forEach((file, index) => {
  const extension = file.name.split('.').pop() || 'jpg';
  const fileName = `image_${Date.now()}_${index}.${extension}`;
  formData.append("images", file, fileName);
});
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ 86 —Å—Ç—Ä–æ–∫ –∏–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å - –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
- ‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å - –ª–∏–±–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ª–∏–±–æ –Ω–∏ –æ–¥–∏–Ω
- ‚úÖ –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞
- ‚úÖ –õ—É—á—à–µ UX - –Ω–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ –ï–¥–∏–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è web –∏ trainer-panel

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û** (–î–µ–∫–∞–±—Ä—å 2024)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∏–ø–æ–≤ –æ—Ç—á–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ + –ø–∏—Å—å–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞) –æ–¥–∏–Ω –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª –¥—Ä—É–≥–æ–π
- –í –ø–∞–Ω–µ–ª–∏ —Ç—Ä–µ–Ω–µ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–∏–ø –æ—Ç—á–µ—Ç–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–æ—Ç–µ—Ä—è—Ç—å —Ä–∞–Ω–µ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏—á–∏–Ω–∞:**
–í `submitExamResult` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `upsert` —Å `undefined` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –ø–æ–ª–µ–π, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: undefined –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ null –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏
update: {
  testAnswers: data.testAnswers ? JSON.stringify(data.testAnswers) : undefined,
  videoReportUrl: data.videoReportUrl || null,
  writtenFeedback: data.writtenFeedback || null,
}
```

**–†–µ—à–µ–Ω–∏–µ:**
–ò–∑–º–µ–Ω–∏–ª–∏ –ª–æ–≥–∏–∫—É –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π:

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è
const updateData: Partial<{...}> = { updatedAt: new Date() };

if (data.testAnswers !== undefined) {
  updateData.testAnswers = JSON.stringify(data.testAnswers);
}
if (data.videoReportUrl !== undefined) {
  updateData.videoReportUrl = data.videoReportUrl;
}
if (data.writtenFeedback !== undefined) {
  updateData.writtenFeedback = data.writtenFeedback;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ —Ç–∏–ø—ã –æ—Ç—á–µ—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ—Å—Ç, –≤–∏–¥–µ–æ –∏ –ø–∏—Å—å–º–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –í –ø–∞–Ω–µ–ª–∏ —Ç—Ä–µ–Ω–µ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –û—á–∏—Å—Ç–∫–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û** (–î–µ–∫–∞–±—Ä—å 2024)

**–ß—Ç–æ –±—ã–ª–æ —É–±—Ä–∞–Ω–æ:**
- ‚ùå –¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `VideoTestMinimal.tsx`
- ‚ùå –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/test-video`
- ‚ùå –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ `console.log` —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ production –∫–æ–¥–∞
- ‚ùå HTML —Ñ–∞–π–ª `debug-video.html`

**–ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (`console.error`)
- ‚úÖ –†–∞–±–æ—á–∞—è –ª–æ–≥–∏–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `src` –≤ `mediaRecorder.onstop`
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ä–µ—à–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Production –∫–æ–¥ –æ—á–∏—â–µ–Ω –æ—Ç –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –∏ –ø–æ–ª–Ω–∞

### –í–µ—Ä—Å–∏—è 2.5.4 - Discriminated Union –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2025

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `type` –≤ –º–æ–¥–µ–ª—å `StepNotification`
- **Discriminated Union:** –ó–∞–º–µ–Ω–µ–Ω –ø–æ–¥—Ö–æ–¥ —Å `stepIndex: -1` –Ω–∞ —è–≤–Ω–æ–µ –ø–æ–ª–µ —Ç–∏–ø–∞
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** TypeScript –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–∂–∞–µ—Ç —Ç–∏–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—è `type`
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –£–±—Ä–∞–Ω—ã "magic numbers" –∏ —É–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```typescript
// –ù–æ–≤—ã–µ —Ç–∏–ø—ã –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
type NotificationType = 'step' | 'immediate';

interface StepNotificationData {
  type: 'step';
  stepTitle: string;
  stepIndex: number;
  url?: string;
}

interface ImmediateNotificationData {
  type: 'immediate';
  title: string;
  body: string;
  url?: string;
}

type NotificationData = StepNotificationData | ImmediateNotificationData;

// TypeScript –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–∂–∞–µ—Ç —Ç–∏–ø—ã
if (notification.type === 'immediate') {
  // notification.title –∏ notification.body –¥–æ—Å—Ç—É–ø–Ω—ã
  // notification.stepTitle –∏ notification.stepIndex –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
}
```

**–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:**
```sql
-- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ type —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º "step"
ALTER TABLE "StepNotification" ADD COLUMN "type" TEXT NOT NULL DEFAULT 'step';

-- –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–∏–ø—É
CREATE INDEX "StepNotification_type_idx" ON "StepNotification"("type");

-- –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ —Å stepIndex = -1 –Ω–∞ —Ç–∏–ø "immediate"
UPDATE "StepNotification" SET "type" = 'immediate' WHERE "stepIndex" = -1;
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
- ‚úÖ **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - TypeScript –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- ‚úÖ **–ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç** - IDE –∑–Ω–∞–µ—Ç –∫–∞–∫–∏–µ –ø–æ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã
- ‚úÖ **–Ø–≤–Ω–æ—Å—Ç—å** - —Ç–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—á–µ–≤–∏–¥–µ–Ω –∏–∑ –∫–æ–¥–∞
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - `notification.type === 'immediate'` –ø–æ–Ω—è—Ç–Ω–æ –≤—Å–µ–º
- ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ magic numbers** - —É–±—Ä–∞–Ω `stepIndex: -1` –∫–∞–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞

**–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:**
- üèÜ **Single Responsibility Principle** - –∫–∞–∂–¥—ã–π —Ç–∏–ø –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –ª–æ–≥–∏–∫—É
- üèÜ **Type Safety** - –ø–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- üèÜ **Explicit over Implicit** - —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ –≤–º–µ—Å—Ç–æ –Ω–µ—è–≤–Ω–æ–≥–æ
- üèÜ **Maintainability** - –∫–æ–¥ –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å, –ø–æ–Ω–∏–º–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å

### –í–µ—Ä—Å–∏—è 2.6 - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫–∑–∞–º–µ–Ω–æ–≤ –≤ —Ç—Ä–µ–Ω–µ—Ä-–ø–∞–Ω–µ–ª–∏

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2025

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- **–§–∏–ª—å—Ç—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:** Toggle "–°–∫—Ä—ã—Ç—å –∑–∞—á—Ç—ë–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ç—Ä–µ–Ω–µ—Ä–∞
- **–°—á—ë—Ç—á–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Å–µ–≥–æ/–æ–∂–∏–¥–∞—é—â–∏—Ö/–∑–∞—á—Ç—ë–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ localStorage
- **URL —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ URL —á–µ—Ä–µ–∑ searchParams
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```typescript
// Server Action —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
export interface GetExamResultsOptions {
  hideCompleted?: boolean;
}

export async function getExamResults(options?: GetExamResultsOptions) {
  const examResults = await prisma.examResult.findMany({
    where: {
      userStep: {
        // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ —Å—Ç–∞—Ç—É—Å—É IN_PROGRESS
        ...(options?.hideCompleted && {
          status: "IN_PROGRESS"
        }),
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
      }
    },
    // ...
  });
}

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ localStorage
export function ExamResultsListWithFilter({ 
  initialExamResults, 
  initialHideCompleted 
}) {
  const [hideCompleted, setHideCompleted] = useState(initialHideCompleted);
  
  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  useEffect(() => {
    const savedPreference = localStorage.getItem('examResults_hideCompleted');
    if (savedPreference !== null) {
      const shouldHide = savedPreference === 'true';
      setHideCompleted(shouldHide);
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ URL
    }
  }, []);
  
  // –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞
  const filteredResults = hideCompleted 
    ? initialExamResults.filter(r => r.userStep.status === "IN_PROGRESS")
    : initialExamResults;
}
```

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```typescript
<FormControlLabel
  control={
    <Switch 
      checked={hideCompleted} 
      onChange={handleToggleChange}
      color="primary"
    />
  }
  label="–°–∫—Ä—ã—Ç—å –∑–∞—á—Ç—ë–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã"
/>

<Chip label={`–í—Å–µ–≥–æ: ${totalResults}`} size="small" variant="outlined" />
<Chip label={`–û–∂–∏–¥–∞—é—Ç: ${pendingCount}`} size="small" color="warning" />
<Chip label={`–ó–∞—á—Ç–µ–Ω—ã: ${completedCount}`} size="small" color="success" />
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ:** –¢—Ä–µ–Ω–µ—Ä –º–æ–∂–µ—Ç —Å–∫—Ä—ã—Ç—å —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è + server-side –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- ‚úÖ **UX:** –°—á—ë—Ç—á–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è:** –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- ‚úÖ **URL-sharable:** –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **Client-side —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- **Server –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **State —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - `useState` –¥–ª—è `examResults` —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ `useEffect`
- **localStorage** –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **URL searchParams** –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–µ–ª–∏—Ç—å—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–∞
- **Graceful fallback** - –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ URL

**–ü–æ—á–µ–º—É server –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –°—á—ë—Ç—á–∏–∫–∏ "–í—Å–µ–≥–æ/–û–∂–∏–¥–∞—é—Ç/–ó–∞—á—Ç–µ–Ω—ã" –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –ü—Ä–∏ –∑–∞—á—ë—Ç–µ —ç–∫–∑–∞–º–µ–Ω–∞ (`router.refresh()`) –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, —Å—á—ë—Ç—á–∏–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

**Troubleshooting: –≠–∫–∑–∞–º–µ–Ω—ã –∏—Å—á–µ–∑–∞—é—Ç –ø–æ—Å–ª–µ –∑–∞—á—ë—Ç–∞**

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–ó–∞—á–µ—Å—Ç—å" —ç–∫–∑–∞–º–µ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞, —Å—á—ë—Ç—á–∏–∫–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:**
1. `router.refresh()` –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
2. –ù–æ `initialExamResults` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –§–∏–ª—å—Ç—Ä "–°–∫—Ä—ã—Ç—å –∑–∞—á—Ç—ë–Ω–Ω—ã–µ" –≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
4. –ó–∞—á—Ç—ë–Ω–Ω—ã–π —ç–∫–∑–∞–º–µ–Ω (status: COMPLETED) —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –Ω–æ —Å—á—ë—Ç—á–∏–∫–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –æ—Ç —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// 1. Server –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –í–°–ï —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
const examResults = await getExamResults({ hideCompleted: false });

// 2. –õ–æ–∫–∞–ª—å–Ω—ã–π state –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
const [examResults, setExamResults] = useState(initialExamResults);

useEffect(() => {
  setExamResults(initialExamResults); // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ props
}, [initialExamResults]);

// 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
const filteredResults = examResults.filter(...)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—á—ë—Ç—á–∏–∫–∏ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –ü–æ—Å–ª–µ –∑–∞—á—ë—Ç–∞ —ç–∫–∑–∞–º–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä –≤–∫–ª—é—á—ë–Ω)
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏ —É–≤–∏–¥–µ—Ç—å –∑–∞—á—Ç—ë–Ω–Ω—ã–π —ç–∫–∑–∞–º–µ–Ω
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –í–µ—Ä—Å–∏—è 2.6.1 - Badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2025

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- **–ö—Ä–∞—Å–Ω—ã–π badge** –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤" –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã
- **–ê–Ω–∏–º–∞—Ü–∏—è pulse** –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è
- **Server-side –ø–æ–¥—Å—á—ë—Ç** –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–∫–∑–∞–º–µ–Ω–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º IN_PROGRESS

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```typescript
// Server Action –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤
export async function getPendingExamCount(): Promise<number> {
  const count = await prisma.examResult.count({
    where: {
      userStep: {
        status: "IN_PROGRESS",
        userTraining: {
          dayOnCourse: {
            course: {
              authorId: session.user.id // –¢–æ–ª—å–∫–æ –∫—É—Ä—Å—ã —Ç—Ä–µ–Ω–µ—Ä–∞
            }
          }
        }
      }
    }
  });
  return count;
}

// Layout —Å badge
const pendingExamCount = await getPendingExamCount();

<Link href="/main-panel/exam-results" className={styles.button}>
  <Assignment />
  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤
  {pendingExamCount > 0 && (
    <span className={styles.badge}>
      {pendingExamCount}
    </span>
  )}
</Link>
```

**CSS —Å—Ç–∏–ª–∏:**
```css
.badge {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background: #ef4444;
  color: white;
  font-size: 0.75rem;
  font-weight: 700;
  min-width: 20px;
  height: 20px;
  border-radius: 10px;
  padding: 0 6px;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.5);
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ** - —Ç—Ä–µ–Ω–µ—Ä —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤
- ‚úÖ **–ù–µ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç** - badge –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è** - –ø–ª–∞–≤–Ω–∞—è –ø—É–ª—å—Å–∞—Ü–∏—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å `count()` –≤–º–µ—Å—Ç–æ –≤—ã–±–æ—Ä–∫–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

---

*–°–∏—Å—Ç–µ–º–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–Ω–∞–Ω–∏–π –∏ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏.*

