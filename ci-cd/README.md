# CI/CD Infrastructure

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
ci-cd/
‚îú‚îÄ‚îÄ docker/                    # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.prod.yml    # –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.smoke.yml   # –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile-*-optimized     # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Dockerfile'—ã
‚îú‚îÄ‚îÄ scripts/                   # CI/CD —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ backup-to-yandex.sh       # –ë—ç–∫–∞–ø –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ setup-github-secrets.sh   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub —Å–µ–∫—Ä–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ setup-server.sh           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ test-docker-build.sh      # –¢–µ—Å—Ç —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ test-web-docker.sh        # –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ configs/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ environment.yml            # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                  # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç –≤—Å–µ—Ö Docker –æ–±—Ä–∞–∑–æ–≤
./ci-cd/scripts/test-docker-build.sh

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
./ci-cd/scripts/test-web-docker.sh
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ–¥–∞–∫—à–µ–Ω
docker-compose -f ci-cd/docker/docker-compose.prod.yml up -d

# –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞
docker-compose -f ci-cd/docker/docker-compose.smoke.yml up -d
```

## üîß GitHub Actions

Workflow —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `.github/workflows/` –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ–∞–π–ª—ã –∏–∑ —ç—Ç–æ–π –ø–∞–ø–∫–∏:

- `ci-cd.yml` - –û—Å–Ω–æ–≤–Ω–æ–π CI/CD pipeline
- `deploy-only.yml` - –¢–æ–ª—å–∫–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- `dependency-check.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üì¶ Docker –æ–±—Ä–∞–∑—ã

–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Dockerfile'—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `ci-cd/docker/`:

- `Dockerfile-web-optimized` - Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `Dockerfile-trainer-panel-optimized` - –ü–∞–Ω–µ–ª—å —Ç—Ä–µ–Ω–µ—Ä–∞
- `Dockerfile-error-dashboard-optimized` - –î–∞—à–±–æ—Ä–¥ –æ—à–∏–±–æ–∫
- `Dockerfile-worker-optimized` - Worker –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- `Dockerfile-bull-board-optimized` - Bull Board
- `Dockerfile-telegram-bot-optimized` - Telegram –±–æ—Ç
- `Dockerfile-prisma-optimized` - Prisma –∫–ª–∏–µ–Ω—Ç

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è** - –≤—Å–µ CI/CD —Ñ–∞–π–ª—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
‚úÖ **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** - –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω—É–∂–Ω—ã–π —Ñ–∞–π–ª
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
