import bcrypt from "bcrypt";

import { prisma } from "./src/index";

const prismaClient = prisma;

async function main() {
  const startTime = Date.now();
  
  console.log("Начинаем сидирование базы данных", {
    environment: process.env.NODE_ENV || 'development',
    databaseUrl: process.env.DATABASE_URL ? 'configured' : 'missing'
  });

  const hashedPassword = await bcrypt.hash("2407041", 10);

  const admin = await prismaClient.user.upsert({
    where: { phone: "+79198031371" },
    update: {},
    create: {
      username: "admin",
      phone: "+79198031371",
      password: hashedPassword,
      role: "ADMIN",
      isConfirmed: true,
    },
  });
  console.log("Админ создан или найден", {
    username: admin.username,
    phone: admin.phone,
    role: admin.role,
    isConfirmed: admin.isConfirmed
  });

  const [homeCourse, streetCourse, puppyCourse, authorCourse] = await prismaClient.$transaction([
    prismaClient.course.upsert({
      where: { type: "home" },
      update: {},
      create: {
        name: "Тренировки дома",
        type: "home",
        description: "Как тренировать хвостика дома",
        shortDesc: "Кратко о курсе",
        duration: "2 недели",
        logoImg: "/uploads/courses/3122311.jpg",
        equipment: "Поводок, игрушки, лакомства",
        trainingLevel: "BEGINNER",
        authorId: admin.id,
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40", // Смешные моменты с собаками
      },
    }),
    prismaClient.course.upsert({
      where: { type: "street" },
      update: {},
      create: {
        name: "Тренировки на улице",
        type: "street",
        description: "Как тренировать хвостика на улице",
        shortDesc: "Кратко о курсе",
        duration: "2 недели",
        logoImg: "/uploads/course-logo.webp",
        equipment: "Поводок, ошейник, лакомства",
        trainingLevel: "INTERMEDIATE",
        authorId: admin.id,
        isPaid: true,
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40", // Смешные собаки на улице
      },
    }),
    prismaClient.course.upsert({
      where: { type: "puppy" },
      update: {},
      create: {
        name: "Щенок на карантине",
        type: "puppy",
        description: "Что делать, пока он маленький",
        shortDesc: "Кратко о курсе",
        duration: "1 месяц",
        logoImg: "/uploads/courses/21312123.jpeg",
        equipment: "Игрушки, лакомства, пеленки",
        trainingLevel: "BEGINNER",
        authorId: admin.id,
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40", // Смешные щенки
      },
    }),
    prismaClient.course.upsert({
      where: { type: "authors" },
      update: {},
      create: {
        name: "Авторский курс",
        type: "authors",
        description: "Супер-методика by Буй с Бугра",
        shortDesc: "Кратко о курсе",
        duration: "много лет",
        logoImg: "/uploads/courses/92086288.jpg",
        equipment: "Специальное оборудование",
        trainingLevel: "EXPERT",
        authorId: admin.id,
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40", // Профессиональная дрессировка
      },
    }),
  ]);
  console.log("Курсы созданы", {
    courseCount: 4,
    courseTypes: ["home", "street", "puppy", "author"]
  });

  const [stepA, stepB, stepC] = await prismaClient.$transaction([
    prismaClient.step.create({
      data: {
        title: "Базовые команды",
        description: `## Основы дрессировки

**Цель:** Обучить собаку базовым командам

### Что изучаем:
- Команда "Сидеть"
- Команда "Лежать" 
- Команда "Стоять"

### Методика:
1. Используйте лакомства как поощрение
2. Повторяйте команды 10-15 раз за сессию
3. Постепенно увеличивайте время выполнения команды

### Оборудование:
- Лакомства
- Поводок`,
        durationSec: 60,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
      },
    }),
    prismaClient.step.create({
      data: {
        title: "Работа с поводком",
        description: `## Правильное использование поводка

**Цель:** Научить собаку ходить рядом без натяжения

### Техника:
- Поводок должен быть свободным
- Собака идет слева от хозяина
- При натяжении - останавливаемся

### Упражнения:
1. Ходьба по прямой
2. Повороты
3. Остановки

### Оборудование:
- Поводок длиной 1.5-2 метра
- Ошейник или шлейка`,
        durationSec: 90,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
      },
    }),
    prismaClient.step.create({
      data: {
        title: "Социализация",
        description: `## Социализация собаки

**Цель:** Приучить собаку к различным ситуациям

### Что включает:
- Встречи с другими собаками
- Контакт с людьми
- Адаптация к шуму

### Этапы:
1. Начинаем с тихих мест
2. Постепенно увеличиваем нагрузку
3. Контролируем реакцию собаки

### Оборудование:
- Поводок
- Лакомства для поощрения
- Игрушки для отвлечения`,
        durationSec: 120,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
      },
    }),
  ]);
  console.log("Базовые шаги созданы", {
    stepCount: 3,
    stepTitles: ["Базовые команды", "Работа с поводком", "Социализация"]
  });

  const baseDay = await prismaClient.trainingDay.create({
    data: {
      title: "Основы дрессировки",
      type: "base",
      equipment: "Поводок длиной 1.5-2 метра, ошейник или шлейка, лакомства, игрушки для отвлечения",
      description: `## День 1: Основы дрессировки

**Цель дня:** Заложить фундамент для дальнейшего обучения собаки

### Что изучаем:
- Базовые команды управления
- Правильную работу с поводком
- Основы социализации

### Структура дня:
1. **Базовые команды** (60 сек) - изучение основных команд
2. **Работа с поводком** (90 сек) - обучение правильной ходьбе
3. **Социализация** (120 сек) - адаптация к различным ситуациям

### Рекомендации:
- Начинайте с коротких сессий
- Используйте позитивное подкрепление
- Будьте терпеливы и последовательны

### Ожидаемый результат:
Собака должна понимать базовые команды и спокойно реагировать на поводок.

`,
      authorId: admin.id,
    },
  });
  await prismaClient.stepOnDay.createMany({
    data: [
      { dayId: baseDay.id, stepId: stepA.id, order: 1 },
      { dayId: baseDay.id, stepId: stepB.id, order: 2 },
      { dayId: baseDay.id, stepId: stepC.id, order: 3 },
    ],
  });
  console.log("Связка шагов с базовым днём выполнена", {
    dayId: baseDay.id,
    stepCount: 3
  });

  for (let i = 1; i <= 14; i++) {
    await prismaClient.dayOnCourse.createMany({
      data: [
        { courseId: homeCourse.id, dayId: baseDay.id, order: i },
        { courseId: streetCourse.id, dayId: baseDay.id, order: i },
      ],
    });
  }
  console.log("Базовый день добавлен в курсы на 14 дней", {
    dayId: baseDay.id,
    courseCount: 4,
    durationDays: 14
  });

  const puppyDay = await prismaClient.trainingDay.create({
    data: {
      title: "Адаптация щенка",
      type: "puppy",
      equipment: "Мягкие игрушки, специальные лакомства для щенков, пеленки, миски для воды и еды",
      description: `## День 1: Адаптация щенка

**Цель дня:** Помочь щенку адаптироваться к новому дому и начать обучение

### Что изучаем:
- Развивающие игры для щенка
- Подготовку к первым прогулкам
- Основы социализации в раннем возрасте

### Структура дня:
1. **Игровая активность** (30 сек) - развивающие игры
2. **Первые прогулки** (30 сек) - подготовка к выходу на улицу

### Особенности работы со щенками:
- Короткие сессии (не более 10-15 минут)
- Много поощрений и игр
- Безопасная среда обучения
- Учет возраста и физических возможностей

### Важные моменты:
- Убедитесь в завершении вакцинации перед прогулками
- Используйте только безопасные игрушки
- Следите за усталостью щенка

### Ожидаемый результат:
Щенок должен быть заинтересован в играх и готов к первым прогулкам.

`,
      authorId: admin.id,
    },
  });
  const [stepP1, stepP2] = await prismaClient.$transaction([
    prismaClient.step.create({
      data: {
        title: "Игровая активность",
        description: `## Развивающие игры для щенка

**Цель:** Развитие координации и социализации

### Рекомендуемые игры:
- Перетягивание мягкой игрушки
- Поиск лакомств
- Игры с мячиком

### Правила:
1. Играйте не более 10-15 минут подряд
2. Следите за усталостью щенка
3. Используйте только безопасные игрушки

### Оборудование:
- Мягкие игрушки без мелких деталей
- Лакомства для щенков

`,
        durationSec: 30,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
      },
    }),
    prismaClient.step.create({
      data: {
        title: "Первые прогулки",
        description: `## Подготовка к прогулкам

**Цель:** Безопасное знакомство с внешним миром

### Подготовка:
- Убедитесь в завершении вакцинации
- Выберите тихое место для первых прогулок
- Начните с коротких выходов (5-10 минут)

### Что изучаем:
- Реакцию на новые звуки
- Поведение при встрече с людьми
- Привыкание к поводку

### Оборудование:
- Легкий поводок
- Ошейник подходящего размера
- Лакомства для поощрения

`,
        durationSec: 30,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
      },
    }),
  ]);
  await prismaClient.stepOnDay.createMany({
    data: [
      { dayId: puppyDay.id, stepId: stepP1.id, order: 1 },
      { dayId: puppyDay.id, stepId: stepP2.id, order: 2 },
    ],
  });
  await prismaClient.dayOnCourse.create({
    data: { courseId: puppyCourse.id, dayId: puppyDay.id, order: 1 },
  });
  console.log("Щенячий день добавлен в курс", {
    dayId: puppyDay.id,
    courseType: "puppy",
    stepCount: 2
  });

  const authorDay = await prismaClient.trainingDay.create({
    data: {
      title: "Продвинутая дрессировка",
      type: "authors",
      equipment: "Кликер, мишени для обучения, препятствия для аджилити, профессиональные лакомства",
      description: `## День 1: Продвинутая дрессировка

**Цель дня:** Освоение профессиональных методов дрессировки по методике "Буй с Бугра"

### Что изучаем:
- Методику позитивного подкрепления
- Использование кликера для точного тайминга
- Поэтапное формирование сложных навыков

### Структура дня:
1. **Методика позитивного подкрепления** (120 сек) - профессиональные техники

### Особенности авторской методики:
- Точный тайминг с помощью кликера
- Поэтапное формирование поведения
- Работа с мотивацией собаки
- Развитие концентрации и интеллекта

### Этапы обучения:
1. **Маркировка поведения** - кликер в момент правильного действия
2. **Подкрепление** - лакомство после кликера
3. **Формирование** - постепенное усложнение задачи

### Практические упражнения:
- Обучение трюкам
- Работа с препятствиями
- Развитие концентрации

### Ожидаемый результат:
Собака должна понимать принципы кликер-дрессировки и быть готова к изучению сложных навыков.

`,
      authorId: admin.id,
    },
  });
  const authorStep = await prismaClient.step.create({
    data: {
      title: "Методика позитивного подкрепления",
      description: `## Продвинутые техники дрессировки

**Цель:** Освоение профессиональных методов обучения

### Методика "Буй с Бугра":
- Использование кликера для точного тайминга
- Поэтапное формирование сложных навыков
- Работа с мотивацией собаки

### Этапы обучения:
1. **Маркировка поведения** - кликер в момент правильного действия
2. **Подкрепление** - лакомство после кликера
3. **Формирование** - постепенное усложнение задачи

### Практические упражнения:
- Обучение трюкам
- Работа с препятствиями
- Развитие концентрации

### Оборудование:
- Кликер для дрессировки
- Разнообразные лакомства
- Мишени и препятствия

`,
        durationSec: 120,
        type: "EXAMINATION",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: admin.id,
    },
  });
  await prismaClient.stepOnDay.create({
    data: { dayId: authorDay.id, stepId: authorStep.id, order: 1 },
  });
  await prismaClient.dayOnCourse.create({
    data: { courseId: authorCourse.id, dayId: authorDay.id, order: 1 },
  });
  console.log("Авторский день добавлен в курс", {
    dayId: authorDay.id,
    courseType: "author",
    stepCount: 1
  });

  await prismaClient.favoriteCourse.createMany({
    data: [
      { userId: admin.id, courseId: homeCourse.id },
      { userId: admin.id, courseId: streetCourse.id },
    ],
    skipDuplicates: true,
  });
  console.log("Курсы добавлены в избранное", {
    userId: admin.id,
    favoriteCount: 4,
    courseTypes: ["home", "street", "puppy", "author"]
  });

  await prismaClient.courseReview.createMany({
    data: [
      {
        userId: admin.id,
        courseId: homeCourse.id,
        rating: 5,
        comment: "Отличный курс, все понравилось!",
      },
      {
        userId: admin.id,
        courseId: streetCourse.id,
        rating: 4,
        comment: "Хороший курс, но хотелось бы больше примеров.",
      },
    ],
    skipDuplicates: true,
  });
  console.log("Отзывы добавлены", {
    reviewCount: 2,
    averageRating: 4.5
  });

  const allCourses = await prismaClient.course.findMany({
    include: { reviews: true },
  });

  for (const course of allCourses) {
    const ratings = course.reviews
      .map((r: { rating: number | null }) => r.rating)
      .filter((r): r is number => typeof r === "number");

    const avg = ratings.length ? ratings.reduce((acc, r) => acc + r, 0) / ratings.length : null;

    await prismaClient.course.update({
      where: { id: course.id },
      data: { avgRating: avg },
    });
  }
  console.log("Средние рейтинги обновлены", {
    courseCount: allCourses.length,
    averageRatings: allCourses.map(c => ({ id: c.id, rating: c.avgRating }))
  });
  const hashedTrainerPassword = await bcrypt.hash("trainer123", 10);

  const trainer = await prismaClient.user.upsert({
    where: { phone: "+79998887766" },
    update: {},
    create: {
      username: "trainer",
      phone: "+79998887766",
      password: hashedTrainerPassword,
      role: "TRAINER",
      isConfirmed: true,
    },
  });
  console.log("Тренер создан", {
    trainerId: trainer.id,
    username: trainer.username,
    phone: trainer.phone,
    role: trainer.role
  });

  const [trainerStep1, trainerStep2] = await prismaClient.$transaction([
    prismaClient.step.create({
      data: {
        title: "Подготовительная разминка",
        description: `## Разминка перед тренировкой

**Цель:** Подготовить собаку к активной работе

### Упражнения разминки:
- Легкая пробежка на поводке
- Растяжка и разогрев мышц
- Психологическая подготовка

### Длительность:
- 5-10 минут для молодых собак
- 10-15 минут для взрослых собак

### Оборудование:
- Поводок
- Лакомства для мотивации

`,
        durationSec: 45,
        type: "TRAINING",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: trainer.id,
      },
    }),
    prismaClient.step.create({
      data: {
        title: "Обучение аппортировке",
        description: `## Развитие навыка аппортировки

**Цель:** Научить собаку приносить и отдавать предметы

### Этапы обучения:
1. **Заинтересованность** - игра с предметом
2. **Преследование** - собака идет за брошенным предметом
3. **Возврат** - принесение предмета хозяину
4. **Отдача** - отпускание предмета по команде

### Методика:
- Начинайте с любимых игрушек собаки
- Используйте лакомства как поощрение
- Постепенно увеличивайте расстояние

### Оборудование:
- Мягкие игрушки для аппортировки
- Лакомства
- Поводок для контроля

`,
        durationSec: 90,
        type: "EXAMINATION",
        videoUrl: "https://www.youtube.com/watch?v=4GdobPQTB40",
        authorId: trainer.id,
      },
    }),
  ]);
  console.log("Шаги тренера созданы", {
    trainerId: trainer.id,
    stepCount: 2,
    stepTitles: ["Подготовительная разминка", "Обучение аппортировке"]
  });

  const [trainerDay1, trainerDay2] = await prismaClient.$transaction([
    prismaClient.trainingDay.create({
      data: {
        title: "Базовая физическая подготовка",
        type: "trainer",
        equipment: "Поводок, лакомства, игрушки для аппортировки, конусы для упражнений",
        description: `## День 1: Базовая физическая подготовка

**Цель дня:** Развить физические способности собаки и подготовить к активным тренировкам

### Что изучаем:
- Подготовительную разминку
- Обучение аппортировке
- Развитие координации и выносливости

### Структура дня:
1. **Подготовительная разминка** (45 сек) - разогрев перед тренировкой
2. **Обучение аппортировке** (90 сек) - развитие навыка принесения предметов

### Особенности физической подготовки:
- Постепенное увеличение нагрузки
- Контроль за состоянием собаки
- Разнообразие упражнений
- Правильная техника выполнения

### Рекомендации:
- Начинайте с легких упражнений
- Следите за дыханием собаки
- Делайте перерывы при необходимости
- Используйте поощрения для мотивации

### Ожидаемый результат:
Собака должна быть физически активной и готовой к более сложным упражнениям.

`,
        authorId: trainer.id,
      },
    }),
    prismaClient.trainingDay.create({
      data: {
        title: "Развитие интеллектуальных навыков",
        type: "trainer",
        equipment: "Пазлы для собак, интерактивные игрушки, кликер, разнообразные лакомства",
        description: `## День 2: Развитие интеллектуальных навыков

**Цель дня:** Стимулировать умственное развитие собаки и развить концентрацию

### Что изучаем:
- Работу с интерактивными игрушками
- Решение простых задач
- Развитие концентрации и памяти

### Структура дня:
1. **Обучение аппортировке** (90 сек) - развитие интеллектуальных навыков
2. **Подготовительная разминка** (45 сек) - умственная разминка

### Особенности интеллектуального развития:
- Постепенное усложнение задач
- Использование различных типов игрушек
- Развитие логического мышления
- Стимулирование любознательности

### Методы обучения:
- Пазлы для собак
- Интерактивные игрушки
- Игры на поиск
- Обучение трюкам

### Рекомендации:
- Начинайте с простых задач
- Поощряйте попытки решения
- Не перегружайте собаку
- Делайте занятия интересными

### Ожидаемый результат:
Собака должна проявлять интерес к решению задач и быть более сосредоточенной.

`,
        authorId: trainer.id,
      },
    }),
  ]);

  await prismaClient.stepOnDay.createMany({
    data: [
      { dayId: trainerDay1.id, stepId: trainerStep1.id, order: 1 },
      { dayId: trainerDay1.id, stepId: trainerStep2.id, order: 2 },
      { dayId: trainerDay2.id, stepId: trainerStep2.id, order: 1 },
      { dayId: trainerDay2.id, stepId: trainerStep1.id, order: 2 },
    ],
  });
  console.log("Дни тренера со связанными шагами созданы", {
    trainerId: trainer.id,
    dayCount: 2,
    totalSteps: 4
  });

  const [trainerCourse1, trainerCourse2] = await prismaClient.$transaction([
    prismaClient.course.create({
      data: {
        name: "Курс тренера 1",
        type: "trainer-course-1",
        description: "Первый курс от тренера",
        shortDesc: "Кратко о первом курсе",
        duration: "3 дня",
        logoImg: "/uploads/courses/trainer1.jpg",
        equipment: "Базовое оборудование для тренировок",
        trainingLevel: "INTERMEDIATE",
        authorId: trainer.id,
      },
    }),
    prismaClient.course.create({
      data: {
        name: "Курс тренера 2",
        type: "trainer-course-2",
        description: "Второй курс от тренера",
        shortDesc: "Кратко о втором курсе",
        duration: "5 дней",
        logoImg: "/uploads/courses/trainer2.jpg",
        equipment: "Продвинутое оборудование",
        trainingLevel: "ADVANCED",
        authorId: trainer.id,
      },
    }),
  ]);

  // Добавляем тренерские дни в оба курса
  await prismaClient.dayOnCourse.createMany({
    data: [
      { courseId: trainerCourse1.id, dayId: trainerDay1.id, order: 1 },
      { courseId: trainerCourse1.id, dayId: trainerDay2.id, order: 2 },
      { courseId: trainerCourse2.id, dayId: trainerDay2.id, order: 1 },
      { courseId: trainerCourse2.id, dayId: trainerDay1.id, order: 2 },
    ],
  });

  console.log("Курсы тренера созданы и дни добавлены в них", {
    trainerId: trainer.id,
    courseCount: 2,
    totalDays: 4
  });

  // Создаем категории для шаблонов шагов
  const [movementCategory, staticsCategory, recallCategory, refusalCategory, stateControlCategory] = await prismaClient.$transaction([
    prismaClient.stepCategory.create({
      data: {
        name: "Движение",
        description: `- движение на провисшем поводке;
- движение рядом у левой и у правой ноги;
- движение без поводка в заданном радиусе;`,
        icon: "🚶",
        order: 1,
      },
    }),
    prismaClient.stepCategory.create({
      data: {
        name: "Статика",
        description: `- Смена позиций лежать, стоять, сидеть по голосовой команде и жесту;
- выдержка в статике при раздражителях в отсутствии проводника;
- высыл по команде на место и сохранения положения столько, сколько необходимо;`,
        icon: "⏸️",
        order: 2,
      },
    }),
    prismaClient.stepCategory.create({
      data: {
        name: "Подзыв",
        description: `- подзыв по рабочей кличке;
- подзыв по команде «ко мне»;
- отзыв от еды, игр с другими собаками и людей;`,
        icon: "📢",
        order: 3,
      },
    }),
    prismaClient.stepCategory.create({
      data: {
        name: "Неподбор",
        description: `- запрещающая команда;
- отказ от лакомства от посторонних людей;
- неподбор по умолчанию;`,
        icon: "🚫",
        order: 4,
      },
    }),
    prismaClient.stepCategory.create({
      data: {
        name: "Контроль состояния",
        description: `- импульс контроль;
- умение расслабляться в новых локациях;
- быстрый переход от возбуждения в спокойное состояние: игра, встреча гостей и т.д.;`,
        icon: "🧘",
        order: 5,
      },
    }),
  ]);
  console.log("Категории шаблонов созданы", {
    categoryCount: 5,
    categories: ["Движение", "Статика", "Подзыв", "Неподбор", "Контроль состояния"]
  });

  // Создаем шаблоны шагов из JSON
  // Создаем шаблоны шагов из JSON
  await prismaClient.$transaction([
    prismaClient.stepTemplate.create({
      data: {
        title: "Подзыв — базовый (рабочая кличка + «ко мне»)",
        description: `## Цель
Научить собаку быстро и уверенно подходить по рабочей кличке и команде «ко мне», занимая фронтальную позицию.

## Оборудование
- Короткий поводок (1.5–2 м)
- Небольшие вкусные лакомства
- (Опционально) кликер или маркерное слово

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке** (например: "Бим!") — это привлекает её внимание.  
2. Отдали немного шаг назад и спокойно скажи «ко мне». Покажи лакомство в руке, но не маши им — дай собачке желание подойти.  
3. Как только подошла — **мгновенно** отметь (клик/«да!»), дай лакомство и коротко покажи, чтобы собака заняла фронтальную позицию.  
4. Заверши упражнение командой **«гуляй»** и выпусти собаку.

## Полезно знать
- Делай короткие повторения (6–10 подходов) и обязательно увеличивай дистанцию постепенно.  
- **Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды** — за супер-быстрый и аккуратный подзыв давай самое ценное угощение.

> Упражнение всегда начинается с подзыва по рабочей кличке и заканчивается командой «гуляй».`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["подзыв", "базовый", "рабочая кличка"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Подзыв — с удержанием / стимуляцией",
        description: `## Цель
Усилить мотивацию собаки бегом к владельцу и повысить скорость подзыва.

## Оборудование
- Ассистент (держит собаку мягко на поводке)
- Высокоценное лакомство или любимая игрушка

## Как выполнять — пошагово
1. Ассистент аккуратно удерживает собаку (не дёргает). Назови питомца по **рабочей кличке**.  
2. Отойди на пару шагов, громко и радостно позови «ко мне». В момент, когда ассистент отпускает, сделай радостный маркер и предложи самое лучшее угощение.  
3. После подхода и отметки дай лакомство и отпусти собакy командой **«гуляй»**.

## Полезно знать
- Удержание — это не наказание: оно временно повышает мотивацию.  
- **Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды** — если подход мгновенный и энергичный, награда должна быть высоким приоритетом.`,
        durationSec: 40,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["подзыв", "удержание", "мотивация"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Подзыв — через провокации (игрушки / лакомства / ассистент)",
        description: `## Цель
Научить отзыву в присутствии сильных отвлекающих стимулов.

## Оборудование
- Несколько игрушек или небольших лакомств, рассыпанные поблизости
- Длинный поводок для безопасности

## Как выполнять — пошагово
1. Положи пару игрушек/кусочков еды на землю и позволь собаке заинтересоваться. Назови по **рабочей кличке** и спокойно дай команду «ко мне».  
2. Если собака откликается — сразу отмечай и давай самое лучшее вознаграждение; если идёт к провокации — мягко переключи внимание (яркий голос/высокоценное лакомство).  
3. Заканчивай упражнение командой **«гуляй»**.

## Полезно знать
- Всегда оставляй страховочный поводок, пока поведение не надёжно.  
- Увеличивай сложность постепенно: сначала 1 игрушка, затем 2–3, затем переходи в парк.

> Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["подзыв", "провокации", "отвлечения"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Подзыв — из игры с другими собаками",
        description: `## Цель
Научить отзыву, когда собака вовлечена в социальную игру.

## Оборудование
- Поле или парк
- Ассистент с другой собакой (контролируемо)
- Длинный поводок

## Как выполнять — пошагово
1. Дай собакам поиграть пару минут. Позови по **рабочей кличке** и скажи «ко мне», используя высокий, радостный тон.  
2. Если собака возвращается — отмечай и давай очень ценное угощение.  
3. Заверши словом **«гуляй»** и, при возможности, разреши вернуться в игру на короткое время.

## Полезно знать
- Отзыв из игры — одна из самых сложных задач; не спеши и делай много прогрессий.  
- **Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды** — особенно важно при больших отвлечениях.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["подзыв", "собаки", "социализация"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Отзыв — этап 30% (короткая дистанция)",
        description: `## Цель
Первый шаг к устойчивому отзыву: короткая дистанция, низкая сложность.

## Оборудование
- Короткий/длинный поводок по желанию
- Лакомства

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке**, отойдя на небольшое расстояние (~30% от целевой дистанции).  
2. Дай команду «ко мне». Как только подошла — кликни/скажи «да!» и дай вознаграждение.  
3. Заканчивай командой **«гуляй»**.

## Полезно знать
- Работай по 6–8 повторов и постепенно увеличивай дистанцию.
- **Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды**.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["отзыв", "прогрессия", "30%"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Отзыв — этап 50% (средняя дистанция)",
        description: `## Цель
Переход к средней дистанции: сохранить скорость и точность.

## Как выполнять — пошагово
1. Отойди на среднюю дистанцию (~50%) и позови по **рабочей кличке**.  
2. Дай «ко мне», используй маркер при подходе и наградь.  
3. Заверши «гуляй».

## Полезно знать
- Вводи лёгкие провокации постепенно (шум, движение людей).  
- За безупречный отзыв давай самое яркое подкрепление.`,
        durationSec: 35,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["отзыв", "прогрессия", "50%"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Отзыв — этап 70% (удлинённая дистанция)",
        description: `## Цель
Отработка отзыва на большой, но не максимальной дистанции.

## Как выполнять — пошагово
1. Отойди на ~70% планируемой дистанции, позови по **рабочей кличке** и скажи «ко мне».  
2. Если собака отвлекается — мягко подстрахуй поводком, при подходе отметь и награди.  
3. Заканчивай «гуляй».

## Полезно знать
- Контролируй безопасность: используй длинный поводок до стабильного результата.  
- **Наиболее яркое подкрепление** — ключевой элемент закрепления.`,
        durationSec: 40,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["отзыв", "прогрессия", "70%"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Отзыв — этап 100% (полный отзыв, контрольная задача)",
        description: `## Цель
Контрольный отзыв: найти устойчивость на полной дистанции и в сложных условиях.

## Как выполнять — пошагово
1. Подготовь место с провокациями (ассистент, игрушки). Назови питомца по **рабочей кличке** и дай «ко мне».  
2. Оцени время подхода, точность позиции; после подхода — отметь, награди и обязательно отпусти «гуляй».  

## Полезно знать
- Используй максимально ценное вознаграждение за идеальный отзыв; если есть сомнения — уменьшай дистанцию и повторяй этапы.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["отзыв", "экзамен", "100%", "контроль"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Провисший поводок — базовый",
        description: `## Цель
Собака идёт рядом без натяжения поводка — спокойный и контролируемый шаг.

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке**, затем начни движение.  
2. Поощряй моменты, когда поводок свободен (маркер/лакомство). При натяжении — остановись и поменяй направление, не тянув питомца.  
3. Заканчивай упражнением командой **«гуляй»**.

## Полезно знать
- Короткие, частые вознаграждения вначале, затем делай их реже.  
- За длительные отрезки без натяжения давай более ценное подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["поводок", "базовый", "провис"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Провисший поводок — с отвлечениями и коррекцией",
        description: `## Цель
Закрепить спокойное движение на поводке в шумной обстановке.

## Как выполнять — пошагово
1. Проводи короткие маршруты в местах с мягкими отвлечениями. Назови по **рабочей кличке** и начинай.  
2. Если собака тянет — используй остановку и смену направления, затем вознаграждай за восстановление провиса.  
3. По окончании скажи **«гуляй»**.

## Полезно знать
- Не перегружай собаку: если устала — сократи сессию.  
- Лучшее выполнение (ровный провис в условиях отвлечений) награждай особенно щедро.`,
        durationSec: 90,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["поводок", "отвлечения", "город"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Движение у ноги — базовое (рядом)",
        description: `## Цель
Научить собаку держаться рядом с владельцем в синхронном движении.

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке**, дай команду «рядом» и начни медленно шагать. Держи лакомство около своей ноги как ориентир.  
2. Отмечай и вознаграждай моменты правильного положения.  
3. Заверши с «гуляй».

## Полезно знать
- Тренируй повороты и смену темпа отдельно.  
- За плавную, без рывков ходьбу дай самое яркое подкрепление.`,
        durationSec: 90,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["рядом", "базовый", "у ноги"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Движение у ноги — с поворотами/провокациями",
        description: `## Цель
Сохранить позицию рядом при манёврах и отвлечениях.

## Как выполнять — пошагово
1. Повтори базовое движение у ноги. Добавь 90° и 180° повороты, а затем небольшие отвлечения.  
2. Отмечай корректные позиции и давай награду.  
3. По окончании — «гуляй».

## Полезно знать
- Работай партиями (например, 3 прохода по 60–90 с).  
- Чем лучше собака удерживает позицию в непростых условиях — тем более яркая награда.`,
        durationSec: 90,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["рядом", "повороты", "сложный"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Повороты на месте в ОП (90°/180°)",
        description: `## Цель
Быстро и аккуратно занимать фронтальную позицию после поворота.

## Как выполнять — пошагово
1. На ходу дай команду остановиться, затем повернись на 90° или 180°.  
2. Назови собаку по **рабочей кличке**, попроси занять ОП, отметь, награди и отпусти «гуляй».  

## Полезно знать
- Тренируй сначала на месте, затем в движении.  
- За ровный и быстрый заход в ОП давай более ценное подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["повороты", "ОП", "остановка"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Статика — высыл на место (коврик) — базовый",
        description: `## Цель
Научить собакe заходить на коврик и выдерживать позицию (2 лапы → 4 лапы → укладка).

## Как выполнять — пошагово
1. Покажи коврик, позови по **рабочей кличке** и отправь командой на коврик.  
2. Маркируй каждый этап: сначала две лапы, затем четыре, затем укладку. Награди за каждый успешный шаг.  
3. Заканчивай «гуляй».

## Полезно знать
- Начинай с коротких выдержек, постепенно увеличивай.  
- За быструю и аккуратную укладку дай самое яркое подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: staticsCategory.id,
        tags: ["коврик", "место", "базовый"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Коврик — мобильное место: перемещение и публичные локации",
        description: `## Цель
Сделать коврик «домиком» для собаки в разных местах: она уверенно зайдёт и выдержит отвлечения.

## Как выполнять — пошагово
1. Перенеси коврик в новую локацию, позови по рабочей кличке и отправь на коврик.  
2. Увеличивай длительность выдержки и добавляй реальные отвлечения (люди, шум).  
3. По завершении давай команду **«гуляй»**.

## Полезно знать
- В новых местах сначала делай короткие сессии.  
- Отличная выдержка на новом коврике заслуживает наилучшего поощрения.`,
        durationSec: 120,
        type: "TRAINING",
        categoryId: staticsCategory.id,
        tags: ["коврик", "публичные места", "генерализация"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Коврик — выдержка с провокациями (кафе / публичные места)",
        description: `## Цель
Укрепить умение не реагировать на еду/шум/людей, сохраняя положение на коврике.

## Как выполнять — пошагово
1. В имитации кафе размести людей и неопасные провокации (пластиковые тарелки, шум).  
2. Отправь собаку на коврик, фиксируй спокойствие и давай награду за выдержку.  
3. Заканчивай «гуляй».

## Полезно знать
- За успешную выдержку в сильных отвлечениях используй наилучшее подкрепление.`,
        durationSec: 120,
        type: "TRAINING",
        categoryId: staticsCategory.id,
        tags: ["коврик", "выдержка", "кафе", "провокации"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Неподбор — открытые боксы",
        description: `## Цель
Научить собаку обходить видимые лакомства без подбора.

## Как выполнять — пошагово
1. Разложи открытые коробочки с лакомствами вдоль маршрута. Назови по **рабочей кличке** и веди собаку.  
2. Если собака идёт мимо — сразу хвали и давай лучшее лакомство отдельно.  
3. Заверши упражнение словом **«гуляй»**.

## Полезно знать
- Начни с лёгких лакомств, затем повышай соблазн.  
- За успешный обход дай особенно ценное вознаграждение.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["неподбор", "открытые боксы"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Неподбор — закрытые боксы (сложный вариант)",
        description: `## Цель
Проверка неподбора, когда содержание боксов скрыто.

## Как выполнять — пошагово
1. Спрячь лакомства в закрытые ёмкости по маршруту. Позови по **рабочей кличке** и веди собаку.  
2. Если собака не вмешивается — отмечай и давай ценную награду.  
3. Заканчивай «гуляй».

## Полезно знать
- Следи за безопасностью (без мелких предметов).  
- Лучшее выполнение — без попыток открыть боксы — награждай щедро.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["неподбор", "закрытые боксы", "сложный"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Неподбор — в связке с другими командами",
        description: `## Цель
Встроить неподбор в реальные последовательности (ходьба рядом, подзыв, коврик).

## Как выполнять — пошагово
1. Сформируй простую связку: движение рядом → прохождение мимо боксов → подзыв.  
2. Назови по кличке в начале и обязательно отпусти «гуляй» в конце.  
3. Поощряй корректное прохождение и выполнение всех элементов.

## Полезно знать
- Связки готовят собаку к реальным сценариям прогулки.  
- За безошибочное прохождение всей цепочки давай наиболее яркое подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["неподбор", "связки", "комплекс"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Остановка из движения по команде «стой»",
        description: `## Цель
Научить моментально останавливаться по команде во время движения.

## Как выполнять — пошагово
1. Находясь в движении, назови по **рабочей кличке** и дай команду «стой».  
2. Как только собака остановилась — отметь и дай лакомство.  
3. Заверши «гуляй».

## Полезно знать
- Тренируй на разных скоростях и поверхностях.  
- Чёткая остановка и без рывков заслуживает наилучшей награды.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: movementCategory.id,
        tags: ["остановка", "стой", "команда"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Удержание (техника усиления подзыва)",
        description: `## Цель
Использовать краткое удержание, чтобы усилить мотивацию к стремительному подзыву.

## Как выполнять — пошагово
1. Ассистент мягко держит собаку (короткая пауза). Назови по **рабочей кличке**.  
2. Дай команду «ко мне», ассистент отпускает — отмечай и награждай ярко.  
3. Заканчивай «гуляй».

## Полезно знать
- Держи удержание мягким и коротким.  
- За энергичный старт после удержания давай лучшее подкрепление.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["удержание", "техника", "подзыв"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Наведение (рука / мишень / поводок) — формирование траектории",
        description: `## Цель
Формировать корректные траектории движения и точные заходы в позицию.

## Как выполнять — пошагово
1. Покажи ладонь/мишень — назови по **рабочей кличке** и веди собаку по нужной траектории.  
2. Постепенно уменьшай физическое наведение, оставляя только сигнал рукой.  
3. По окончании — «гуляй» и награда.

## Полезно знать
- Наведение помогает при поворотах и заходах.  
- За чистую, выполненную траекторию давай наилучшее подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["наведение", "мишень", "техника"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Шейпинг / маркировка предложенного поведения",
        description: `## Цель
Формировать сложные или новых поведенческие элементы методом шейпинга и маркировки.

## Как выполнять — пошагово
1. Назначь маркер (клик/слово) и начни отмечать маленькие шаги поведения.  
2. Каждое приближение к цели — отмечай и награждай.  
3. После успешного выполнения завершай «гуляй».

## Полезно знать
- Шейпинг требует терпения, но даёт точные результаты.  
- За идеальное исполнение используй самое яркое подкрепление.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["шейпинг", "маркировка", "поведение"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Высы́л вперёд и отзыв на место — длительная выдержка",
        description: `## Цель
Научить уходу на точку и выдержке до 2–3 минут с последующим отзывом.

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке**, высылай на заданное место и проси лечь/выдержать.  
2. Отойди на расстояние, затем дай команду «ко мне», отметь подход и снова отправь на выдержку.  
3. Заканчивай «гуляй».

## Полезно знать
- Увеличивай выдержку по 15–30 секунд за сессию.  
- Отличная выдержка и отзыв — повод дать самое яркое подкрепление.`,
        durationSec: 120,
        type: "TRAINING",
        categoryId: staticsCategory.id,
        tags: ["высыл", "выдержка", "дистанция"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Отзыв в городе — контрольная задача с ассистентом и провокациями",
        description: `## Цель
Проверить отзыв в городской среде с реальными отвлечениями.

## Как выполнять — пошагово
1. Подготовь контролируемую городскую обстановку, назови по **рабочей кличке** и дай «ко мне».  
2. Оцени скорость и точность; при хорошем выполнении — отмечай и награждай; завершай «гуляй».  

## Полезно знать
- Помни про безопасность (дороги, прохожие).  
- За надёжный городской отзыв давай самое ценное угощение.`,
        durationSec: 90,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["отзыв", "город", "контроль", "провокации"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Контроль состояния — переход возбуждение → спокойствие",
        description: `## Цель
Научить собаку быстро переключаться из состояния возбуждения в спокойное по команде.

## Как выполнять — пошагово
1. После игры назови по **рабочей кличке** и дай команду на релакс (например, «лежать» или отправь на коврик).  
2. Как только собака успокоится — отметь и награди, затем отпусти «гуляй».  

## Полезно знать
- Короткие и частые упражнения повышают успех.  
- За быстрое и чистое переключение давай яркое подкрепление.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["контроль", "возбуждение", "спокойствие"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Генерализация навыков в городской среде",
        description: `## Цель
Перенести навыки с тренировочной площадки на реальные маршруты и места.

## Как выполнять — пошагово
1. Выполняй короткие сессии у магазинов, остановок и в парках: назови по кличке, сделай короткое упражнение, закончи «гуляй».  
2. Записывай результаты, корректируй план и повышай сложность постепенно.

## Полезно знать
- Постепенная генерализация — ключ к стабильности.  
- За успех в реальных условиях давай самое яркое подкрепление.`,
        durationSec: 90,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["генерализация", "город", "практика"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Фокус / «Смотри на меня» (Watch Me)",
        description: `## Цель
Научить собаку смотреть владельцу в глаза по сигналу — базовый инструмент удержания внимания и профилактики отвлечений.

## Оборудование
- Маленькие лакомства
- Тихое место для старта

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке** и поднеси лакомство близко к своему лицу. Скажи «смотри» или «смотри на меня».  
2. Как только собака поднимает глаза на тебя — **мгновенно** отметь (клик/«да») и дай лакомство.  
3. Повторяй короткими сериями (10–15 повторов), постепенно увеличивая длительность контакта и задерживая награду на 1–2 секунды.  
4. В конце сессии всегда говори **«гуляй»**.

## Прогрессия
- Увеличивай время удержания взгляда.  
- Переноси упражнение в более шумные места.

## Советы
- Держи голос радостным и лакомства маленькими.  
- Фокус — отличный «переходник» перед сложной задачей: попросил взглянуть → дал команду.

> Важно: подзыв по рабочей кличке и отпуск по команде «гуляй» являются обязательными компонентами каждого упражнения.

> Наиболее яркое подкрепление предоставляется собаке после лучшего выполнения команды.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["фокус", "внимание", "смотри"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Leave It — отказ от предмета в руках",
        description: `## Цель
Научить собаку отказываться от предмета, который находится в твоей руке — важная безопасность в быту.

## Оборудование
- Два вида лакомств: обычное и более ценное (лучшее)

## Как выполнять — пошагово
1. Назови собаку по **рабочей кличке**, покажи невкусный предмет в открытой ладони и одновременно закрой ладонь, сказав «leave it»/«нельзя».  
2. Как только собака отходит или прекращает интерес — отметь и дай лучшее лакомство из другой руки.  
3. Повторяй, постепенно оставляя предмет открытым дольше.  
4. Заканчивай **«гуляй»**.

## Полезно знать
- Меняй скорость прогрессии в зависимости от интереса собаки к предмету.  
- За чистый отказ давай наиболее яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["leave it", "отказ", "нельзя"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Drop It / Give — отдача предмета",
        description: `## Цель
Научить собаку отдавать предмет по команде без сопротивления — важно для безопасных игр и отдачи находок.

## Оборудование
- Игрушка и высокоценное лакомство для обмена

## Как выполнять — пошагово
1. Назови по **рабочей кличке** и поощри игру с предметом.  
2. Поднеси лакомство к морде и скажи «дай»/«отдай». Как только собака выпустит предмет — отметь и дай лакомство.  
3. Практикуй обмен: «отдал — получил».  
4. Заверши «гуляй».

## Советы
- Не тяните предмет силой — используйте трейд (обмен на лучшее).  
- За спокойную и быструю отдачу давайте самое яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["drop it", "отдача", "дай"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Экстренный отзыв (Emergency Recall)",
        description: `## Цель
Создать отдельный, очень сильный сигнал для немедленного возврата собаки в опасной ситуации.

## Оборудование
- Самое ценное лакомство/игрушка
- Безопасная огороженная зона для тренировки

## Как выполнять — пошагово
1. Выбери короткое, уникальное слово или свисток как сигнал экстренного отзыва. Назови собаку по **рабочей кличке** и проговори сигнал.  
2. Жди, пока собака отойдет на небольшое расстояние, затем подай сигнал и позови «ко мне» радостным голосом.  
3. Как только собака пришла — давай самое лучшее подкрепление (игра/кусок еды).  
4. Заверши «гуляй».

## Прогрессия
- Увеличивай дистанцию и сложность, но только после уверенных коротких успехов.  
- Тренируй в безопасной, контролируемой среде.

## Важно
- Экстренный отзыв требует редких, но очень мощных наград; используйте его только в серьёзных ситуациях и проверяйте регулярно.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["экстренный отзыв", "безопасность", "свисток"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Ждать у порога / Door Manners",
        description: `## Цель
Научить собаку спокойно ждать у двери, не выбегать и не прыгать на гостей.

## Оборудование
- Поводок, если нужно
- Лакмства для награды

## Как выполнять — пошагово
1. Назови по **рабочей кличке**, попроси собаку «садись/ждать» на безопасном расстоянии от двери.  
2. Открывай дверь на секунду и тут же закрой; если собака осталась — отметь и награди.  
3. Постепенно увеличивай время ожидания и сложность (шум, человек на пороге).  
4. Заканчивай «гуляй».

## Советы
- Делай небольшие шаги прогрессии, поощряй спокойствие.  
- За идеальное ожидание у двери давай особенно яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["порог", "ждать", "двери"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Крейт / приучение к месту сна (Crate settling)",
        description: `## Цель
Сделать крейт/место отдыха приятным: собака спокойно и добровольно входит и остаётся в нём.

## Оборудование
- Крейт/матрасик, любимая игрушка, лакомства

## Как выполнять — пошагово
1. Назови по **рабочей кличке**, заманивай собаку в крейт лакомством и закрывай дверь на короткое время.  
2. После спокойного поведения — открой и отмечай наградой за спокойствие.  
3. Увеличивай время пребывания постепенно.  
4. Всегда освобождай командой **«гуляй»**.

## Полезно знать
- Крейt — безопасное место, не наказание.  
- За спокойную, расслабленную укладку в крейте давай яркое подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: staticsCategory.id,
        tags: ["крейт", "место", "покой"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Десенсибилизация к прикосновениям / Handling",
        description: `## Цель
Привыкание к прикосновениям (груминг, ветеринарные осмотры) без стресса.

## Оборудование
- Небольшие лакомства
- Мягкие поглаживания, постепенные шаги

## Как выполнять — пошагово
1. Назови по **рабочей кличке**, прикоснись к лапе/уху ненадолго и сразу дай лакомство.  
2. Повторяй, постепенно увеличивая длительность касания и переходя к другой части тела.  
3. Заканчивай «гуляй».

## Советы
- Работай короткими сессиями и укрепляй позитивную ассоциацию с прикосновениями.  
- За спокойное принятие манипуляций — особо яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["прикосновения", "handling", "десенсибилизация"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Targeting / Touch — коснуться руки или мишени",
        description: `## Цель
Научить собаку целенаправленно касаться рукой/мишенью носом — основа для трюков и точных заходов.

## Оборудование
- Мишень (тарелка, маленькая доска) и лакомства

## Как выполнять — шаги
1. Назови собаку по **рабочей кличке** и покажи мишень.  
2. Когда собака коснулась мишени носом — отметь и дай лакомство.  
3. Повторяй, усложняя: дистанция, направление, повороты.  
4. Заверши «гуляй».

## Полезно знать
- Targeting хорошо интегрируется в игры и трюки.  
- За точный, быстрый контакт — самое яркое подкрепление.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["targeting", "touch", "мишень"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Trade / «Сдай — получи» (обмен предметов)",
        description: `## Цель
Научить собаку безопасно обменивать предмет на более ценное вознаграждение.

## Оборудование
- Игрушка/предмет и значительно более вкусное лакомство

## Как выполнять — пошагово
1. Назови по **рабочей кличке**, дай собаке предмет для игры.  
2. Поднеси лакомство и скажи «обмен»/«дай»; когда собака отпускает предмет — немедленно отдай лакомство.  
3. Повторяй в игровых ситуациях и на прогулке.  
4. Заканчивай «гуляй».

## Советы
- Обмен уменьшает конфликт вокруг ресурсов — работает лучше, чем отбор силой.  
- За спокойный обмен давай особенно яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: refusalCategory.id,
        tags: ["trade", "обмен", "ресурсы"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Развивка разлуки / постепенное привыкание (Separation Desensitization)",
        description: `## Цель
Постепенно приучать собаку находиться в одиночестве без тревоги.

## Оборудование
- Короткие выходы, спокойная рутина, специальная игрушка-занятие

## Как выполнять — пошагово
1. Назови по **рабочей кличке**, сделай ритуал перед уходом (короткая команда), затем выходи на 10–30 секунд.  
2. Возвращайся спокойно, не устраивая сцены, и дай поощрение за спокойствие.  
3. Постепенно увеличивай время отсутствия по плану.  
4. Всегда завершай с «гуляй» при возвращении к активности.

## Полезно знать
- Делай маленькие шаги; при признаках сильной тревоги обратись к специалисту.  
- За спокойные промежутки одиночества — положительное подкрепление хозяйства.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["разлука", "separation", "тревога"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Игры на самообладание / импульс-контроль",
        description: `## Цель
Развивать способность ждать и контролировать порывы (еда, старт игры).

## Оборудование
- Лакомства, игрушки

## Как выполнять — шаги
1. Назови по **рабочей кличке**, покажи лакомство и скажи «ждать».  
2. Удержись 1–5 секунд, затем дай сигнал к действию; при успешном ожидании — дай лакомство.  
3. Игра «подожди — бери» отлично развивает самоконтроль.  
4. Завершение — «гуляй».

## Советы
- Начинай с минимального ожидания и наращивай.  
- За выдержку давай более яркое подкрепление.`,
        durationSec: 30,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["импульс-контроль", "самообладание", "ожидание"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Threshold / триггер-менеджмент (работа до точки кипения)",
        description: `## Цель
Учиться замечать и работать до того момента, когда собака «перегревается», чтобы переработать поведение в спокойной зоне.

## Как выполнять — шаги
1. Назови по **рабочей кличке**, наблюдай за ранними признаками возбуждения (взгляд, тело).  
2. До достижения критической точки переключи внимание (фокус, подзыв) и дай короткое задание с наградой.  
3. Повторяй — цель: отработать поведение до критического момента, а не после.  
4. Всегда завершаешь «гуляй».

## Полезно знать
- Это профилактический подход: лучше предотвратить, чем исправлять.  
- За своевременное переключение — самое яркое подкрепление.`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["threshold", "триггеры", "профилактика"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Дистанционный свист / дистанционный отзыв",
        description: `## Цель
Развить надёжный отзыв на свист или другой дистанционный сигнал для больших площадей.

## Оборудование
- Свисток (или уникальный сигнал), безопасная площадка, высокоценное вознаграждение

## Как выполнять — шаги
1. Назови по **рабочей кличке**, установи свист как индикатор: свист — маркер — команда «ко мне» в первые этапы.  
2. Тренируй на коротке расстоянии, затем увеличивай дистанцию.  
3. Когда отзыв надёжен — используй свист как основной дистанционный сигнал.  
4. Завершай «гуляй».

## Советы
- Свист должен быть один и тот же звук; используйте его экономно и только в отработанных ситуациях.  
- За идеальный отзыв со свистом давайте самое яркое подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: recallCategory.id,
        tags: ["свисток", "дистанция", "отзыв"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Порядок кормления / манеры у миски (Food-bowl manners)",
        description: `## Цель
Воспитать аккуратные и безопасные привычки вокруг еды: ожидание, спокойствие и отдача.

## Как выполнять — шаги
1. Назови по **рабочей кличке**, попроси «сиди» перед миской.  
2. Поставь миску, отступи и дай команду «можно» или используйте «гуляй» как отпуск при завершении приёма пищи.  
3. Для практики отдачи: предлагаем замену в обмен на предмет.  

## Полезно знать
- Последовательность в рутине кормления уменьшает напряжение вокруг еды.  
- За спокойное ожидание и порядок у миски — яркое подкрепление (похвала/лакомство).`,
        durationSec: 45,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["кормление", "миска", "манеры"],
        authorId: admin.id,
      },
    }),
    prismaClient.stepTemplate.create({
      data: {
        title: "Уверенность и социализация (Confidence building)",
        description: `## Цель
Повышать уверенность робких или застенчивых собак через контролируемые, позитивные контакты и маленькие успехи.

## Как выполнять — шаги
1. Назови питомца по **рабочей кличке** и предложи простые задания (targeting, короткий подзыв), которые он успешно выполнит.  
2. Организуй позитивные, контролируемые встречи с людьми/собаками; хвалите и награждайте за спокойное поведение.  
3. Постепенно усложняйте задачи, фиксируя прогресс.  
4. Всегда закрывайте сессию командой «гуляй».

## Советы
- Мелкие, частые успехи укрепляют уверенность лучше, чем один большой шаг.  
- За проявленную смелость и правильное поведение давайте самое яркое подкрепление.`,
        durationSec: 60,
        type: "TRAINING",
        categoryId: stateControlCategory.id,
        tags: ["уверенность", "социализация", "робость"],
        authorId: admin.id,
      },
    }),
  ]);
  console.log("Шаблоны шагов созданы из JSON", {
    templateCount: 27,
    categories: 5,
    categoryNames: ["Движение", "Статика", "Подзыв", "Неподбор", "Контроль состояния"]
  });

  console.log("Seed успешно выполнен", {
    totalOperations: 19,
    duration: Date.now() - startTime,
    environment: process.env.NODE_ENV || 'development'
  });
}

main()
  .then(() => prismaClient.$disconnect())
  .catch((e) => {
    console.error("Ошибка при сидировании", e as Error, {
      environment: process.env.NODE_ENV || 'development',
      databaseUrl: process.env.DATABASE_URL ? 'configured' : 'missing'
    });
    prismaClient.$disconnect().finally(() => process.exit(1));
  });
