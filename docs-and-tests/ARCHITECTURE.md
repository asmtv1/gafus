# Архитектура проекта GAFUS

## Обзор

Проект использует доменно-ориентированную архитектуру с четким разделением ответственности между слоями.

## Структура приложений

### Trainer Panel (`apps/trainer-panel`)

```
src/
├── app/                    # Next.js App Router
├── features/              # Доменные фичи
│   ├── courses/          # Управление курсами
│   │   ├── components/
│   │   ├── hooks/
│   │   ├── lib/
│   │   └── types/
│   ├── steps/            # Управление шагами
│   ├── statistics/       # Статистика
│   └── users/           # Управление пользователями
├── shared/               # Общие ресурсы
│   ├── components/
│   │   ├── ui/          # Базовые UI компоненты
│   │   └── common/      # Переиспользуемые компоненты
│   ├── hooks/           # Общие хуки
│   ├── lib/             # Общие библиотеки
│   │   ├── actions/     # Server Actions
│   │   ├── utils/       # Утилиты
│   │   └── validation/  # Валидация
│   ├── providers/       # Провайдеры
│   └── types/           # Общие типы
├── widgets/              # Сложные композитные компоненты
└── utils/               # Утилиты приложения
```

### Web (`apps/web`)

```
src/
├── app/                    # Next.js App Router
├── features/              # Доменные фичи
│   ├── courses/          # Курсы для пользователей
│   ├── training/         # Тренировки
│   ├── profile/          # Профиль пользователя
│   ├── statistics/       # Статистика
│   └── pets/            # Питомцы
├── shared/               # Общие ресурсы
│   ├── components/
│   ├── hooks/
│   ├── lib/
│   ├── providers/
│   ├── stores/          # Сторы (Zustand)
│   └── constants/       # Константы
├── widgets/              # Сложные композитные компоненты
└── utils/               # Утилиты приложения
```

### Error Dashboard (`apps/error-dashboard`)

```
src/
├── app/                    # Next.js App Router
├── features/              # Доменные фичи
│   ├── errors/           # Управление ошибками
│   ├── auth/             # Аутентификация
│   └── filters/          # Фильтры
├── shared/               # Общие ресурсы
│   ├── components/
│   ├── hooks/
│   ├── lib/
│   ├── providers/
│   ├── contexts/         # React Contexts
│   └── types/
├── widgets/              # Сложные композитные компоненты
└── utils/               # Утилиты приложения
```

## Правила импортов

### ✅ Разрешено:

- `features/*` → `shared/*`
- `widgets/*` → `features/*` + `shared/*`
- `app/*` → `features/*` + `shared/*` + `widgets/*`

### ❌ Запрещено:

- `shared/*` → `features/*`
- `features/courses/*` → `features/statistics/*` (через `shared/*`)

## Домены (Features)

### Trainer Panel

- **courses** - управление курсами (создание, редактирование, настройка доступа)
- **steps** - управление шагами и днями тренировок
- **statistics** - статистика и аналитика
- **users** - поиск и управление пользователями

### Web

- **courses** - просмотр и прохождение курсов
- **training** - тренировки и прогресс
- **profile** - профиль пользователя
- **statistics** - личная статистика
- **pets** - управление питомцами

### Error Dashboard

- **errors** - просмотр и управление ошибками
- **auth** - аутентификация
- **filters** - фильтрация ошибок

## Shared слой

### Components

- **ui/** - базовые UI компоненты (Button, Input, Modal, etc.)
- **common/** - переиспользуемые бизнес-компоненты

### Hooks

- Общие хуки для работы с данными
- Хуки для валидации форм
- Хуки для статистики

### Lib

- **actions/** - Server Actions
- **utils/** - общие утилиты
- **validation/** - правила валидации

### Providers

- Провайдеры для состояния приложения
- Провайдеры для внешних сервисов

## Widgets

Сложные композитные компоненты, которые используют несколько фич:

- `StatisticsWidget` - виджет статистики
- `CourseManagementWidget` - виджет управления курсами
- `ErrorWidget` - виджет ошибок

## Преимущества новой архитектуры

1. **Четкое разделение ответственности** - каждый домен изолирован
2. **Переиспользование** - общие компоненты в shared слое
3. **Масштабируемость** - легко добавлять новые фичи
4. **Читаемость** - понятная структура для новых разработчиков
5. **Изоляция изменений** - изменения в одной фиче не влияют на другие

## Миграция

Миграция проведена поэтапно:

1. ✅ Создана новая структура папок
2. ✅ Перемещены компоненты по доменам
3. ✅ Обновлены импорты
4. ✅ Настроены пути в tsconfig.json
5. ✅ Удалены старые папки

Все бизнес-логика и функциональность остались неизменными.
