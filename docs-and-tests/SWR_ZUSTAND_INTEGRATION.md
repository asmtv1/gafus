# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SWR —Å Zustand Store

## üéØ –¶–µ–ª—å

–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SWR –∏ Zustand –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ UX:

- **SWR**: –§–æ–Ω–æ–≤–∞—è —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è, –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **Zustand**: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   SWR Cache     ‚îÇ    ‚îÇ  Zustand Store  ‚îÇ    ‚îÇ   Components    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ –§–æ–Ω–æ–≤–∞—è       ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ ‚Ä¢ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ ‚Ä¢ UI Components ‚îÇ
‚îÇ   —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è   ‚îÇ    ‚îÇ ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω—ã–µ     ‚îÇ    ‚îÇ ‚Ä¢ –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ ‚îÇ
‚îÇ ‚Ä¢ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è  ‚îÇ    ‚îÇ   –¥–∞–Ω–Ω—ã–µ        ‚îÇ    ‚îÇ   –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è    ‚îÇ
‚îÇ ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è‚îÇ    ‚îÇ ‚Ä¢ –ö—ç—à –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π‚îÇ    ‚îÇ ‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏—è     ‚îÇ
‚îÇ   –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è   ‚îÇ    ‚îÇ ‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞     ‚îÇ    ‚îÇ   –∑–∞–≥—Ä—É–∑–∫–∏      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

- ‚úÖ **SWR**: –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –∏–∑ –∫—ç—à–∞
- ‚úÖ **Zustand**: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- ‚úÖ **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π**: –õ—É—á—à–µ–µ –∏–∑ –¥–≤—É—Ö –º–∏—Ä–æ–≤

### 2. **UX**

- ‚úÖ **–§–æ–Ω–æ–≤–∞—è —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è**: –î–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- ‚úÖ **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π UI –æ—Ç–∫–ª–∏–∫
- ‚úÖ **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è**: –ò–∑–±–µ–≥–∞–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 3. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**

- ‚úÖ **–ï–¥–∏–Ω—ã–π API**: –ü—Ä–æ—Å—Ç—ã–µ —Ö—É–∫–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ **TypeScript**: –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞**: –õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –•—É–∫–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

```typescript
// apps/web/src/hooks/useCourseStoreSWR.ts

// –•—É–∫ –¥–ª—è –∫—É—Ä—Å–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π SWR + Zustand
export function useCoursesWithStore() {
  const store = useCourseStore();
  const { mutate } = useMutate();

  // SWR –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
  const {
    data: swrData,
    error,
    isLoading,
  } = useData("courses:all", () => getCoursesWithProgress().then((result) => result.data), {
    revalidateOnFocus: false,
    dedupingInterval: 60000, // 1 –º–∏–Ω—É—Ç–∞
  });

  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Zustand –∏–ª–∏ SWR
  const getData = () => {
    if (swrData) return swrData;
    if (store.allCourses && !store.isStale(store.allCourses)) {
      return store.allCourses.data;
    }
    return [];
  };

  return {
    data: getData(),
    error: error || store.errors.all,
    isLoading: isLoading || store.loading.all,
    invalidateCourses: () => {
      mutate("courses:all");
      store.setAllCourses([], "all");
    },
  };
}
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º:

```typescript
// apps/web/src/components/CourseCard/CourseListHybrid.tsx

export default function CourseListHybrid({ title, filter }) {
  const {
    data: courses,
    error,
    isLoading,
    invalidateCourses
  } = useCoursesWithStore();

  if (isLoading) return <CircularProgress />;
  if (error) return <ErrorMessage error={error} />;

  const filteredCourses = filter ? courses.filter(filter) : courses;

  return (
    <Box>
      <Typography variant="h4">{title}</Typography>
      <CourseGrid courses={filteredCourses} />
    </Box>
  );
}
```

## üìà –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### SWR –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```typescript
// –ö—É—Ä—Å—ã - 1 –º–∏–Ω—É—Ç–∞
dedupingInterval: 60000,
revalidateOnFocus: false

// –ò–∑–±—Ä–∞–Ω–Ω–æ–µ - 5 –º–∏–Ω—É—Ç
dedupingInterval: 300000,
revalidateOnFocus: false

// –ê–≤—Ç–æ—Ä—Å–∫–∏–µ –∫—É—Ä—Å—ã - 5 –º–∏–Ω—É—Ç
dedupingInterval: 300000,
revalidateOnFocus: false
```

### Zustand –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```typescript
// –ö—É—Ä—Å—ã - 10 –º–∏–Ω—É—Ç
CACHE_DURATION = 10 * 60 * 1000;

// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - 30 –º–∏–Ω—É—Ç
IMAGE_CACHE_DURATION = 30 * 60 * 1000;

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - 24 —á–∞—Å–∞
STATS_CACHE_DURATION = 24 * 60 * 60 * 1000;
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–º–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```typescript
// –ë—ã–ª–æ (—Ç–æ–ª—å–∫–æ Zustand)
import { useCourseStoreActions } from "@/stores/courseStore";

// –°—Ç–∞–ª–æ (SWR + Zustand)
import { useCoursesWithStore } from "@/hooks/useCourseStoreSWR";
```

### 2. –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

```typescript
// –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
const { data, invalidateCourses } = useCoursesWithStore();

// –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
const handleFavorite = async (courseId) => {
  // –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º UI
  optimisticUpdate((courses) =>
    courses.map((c) => (c.id === courseId ? { ...c, isFavorite: !c.isFavorite } : c)),
  );

  // –ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Ä–≤–µ—Ä
  await toggleFavorite(courseId);
  invalidateCourses();
};
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: -70% –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤**: -80% –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é
- **UX**: –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ SWR –ø—Ä–æ–≤–∞–π–¥–µ—Ä
const config = {
  onSuccess: (data, key) => {
    console.log(`‚úÖ SWR Cache Hit: ${key}`);
    analytics.track("cache_hit", { key });
  },
  onError: (error, key) => {
    console.error(`‚ùå SWR Error: ${key}`, error);
    analytics.track("cache_error", { key, error: error.message });
  },
};
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω:

1. **–≠—Ç–∞–ø 1**: –î–æ–±–∞–≤–∏—Ç—å SWR –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
2. **–≠—Ç–∞–ø 2**: –°–æ–∑–¥–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–µ —Ö—É–∫–∏
3. **–≠—Ç–∞–ø 3**: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–≠—Ç–∞–ø 4**: –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
5. **–≠—Ç–∞–ø 5**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:

- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Zustand –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ breaking changes
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –∫ —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SWR + Zustand –¥–∞–µ—Ç:

- ‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- ‚úÖ **–û—Ç–ª–∏—á–Ω—ã–π UX**
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

–í—Å–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SWR –∏ Zustand –≤ –æ–¥–Ω–æ–º —Ä–µ—à–µ–Ω–∏–∏! üöÄ
